<%
	Server.Execute( "include/user_init.html" );
	question = ( Request.Query.HasProperty( 'question' ) ? UrlDecode( Request.Query.question ) : '' );
	answer = ( Request.Query.HasProperty( 'answer' ) ? String( Request.Query.answer ) : '' );
	emailCorp = ( Request.Query.HasProperty( 'email' ) ? String( Request.Query.email ) : '' );
	
	codeStruct = {};
	codeStruct['0']='В каком году Вы окончили школу?';
	codeStruct['1']='О какой профессии Вы мечтали в детстве?';
	codeStruct['2']='Какое отчество Вашей матери?';
	codeStruct['3']='Как имя Вашего лучшего друга детства?';
	codeStruct['4']='Город, где Вы отдыхали в прошлый раз?';
	
	if (question != '' && answer !='') {
		doc = OpenDoc(UrlFromDocID(curUserID));
		doc.TopElem.custom_elems.ObtainChildByKey("secretQuestion").value = Trim(question) + ":" + codeStruct[question];
		doc.TopElem.custom_elems.ObtainChildByKey("secretAnswer").value = Trim(StrLowerCase(answer));
		if (doc.TopElem.email == '') {
			doc.TopElem.email = Trim(StrLowerCase(emailCorp));
		}
		try{
			doc.Save();
			Request.Redirect( "secret_word.html?m=1" );
			break;
		} catch(e) {
			alert('Невозможно обновить данные сотрудника: ' + ExtractUserError(e));
		}
	}
%>