<%Server.Execute( "include/user_init.html" )%>

<%  
	_err = 0;
	try
	{
		object_id = Int(Request.Form.object_id);
		collaborator_id = Int(Request.Form.collaborator_id);
		doc_id = Int(Request.Form.doc_id);
	}
	catch(_shit_)
	{
		_err = 1;
	}

	if (_err == 0)
	{
		docResponse = OpenDoc(UrlFromDocID(object_id));	
		cur_user = docResponse.TopElem.collaborators.GetOptChildByKey(collaborator_id);
		if (cur_user == undefined)
			_err = 2;
		else
		{
			cur_user.date = Date();
			cur_user.acquaint = true;
			docResponse.Save();
		}
	}
			
	_href = 'view_doc.html?mode=acquaint&doc_id=' + doc_id;
	if (_err == 1)
		_href = _href + "&error=" + _err;
	else 
		_href = _href + "&object_id=" + object_id +  ( _err > 0 ? "&error=" + _err : "&is_post=1");
		
	Response.Redirect( _href );
%>