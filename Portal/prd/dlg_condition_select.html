<%	Server.Execute( "include/access_init.html" );	Server.Execute( "include/head.html" );	try	{		fldCatalog = curLngCommon.exchange_object_types.GetChildByKey(Request.QueryString.catalog_name);	}	catch(_wtf_)	{		Response.Write("Error: Invalid catalog name");		Cancel();	}		sFieldForm = '	<?xml version="1.0" encoding="windows-1251"?>	<SPXML-INLINE-FORM>		<USE FORM="x-local://wtv/ms_general.xmd"/>		<tempor_field_form0529>			<INHERIT TYPE="field_names_base"/>		</tempor_field_form0529>	</SPXML-INLINE-FORM>';		RegisterFormFromStr('tempor_field_form0529', sFieldForm);		listFieldNames = OpenNewDoc('tempor_field_form0529').TopElem;	tools.fill_field_names( listFieldNames.field_names, fldCatalog.name, false );%><HTML> <HEAD><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"/><title><%=tools_web.get_web_str('dcs_edit_cond')%> (<%=fldCatalog.title%>)</title><LINK HREF="style.css" REL="stylesheet" TYPE="text/css"/><script language="javascript"><!--	function __addCondition(oCondition)	{		var _sField = oCondition.field;		var _sType = oCondition.type;		var _sOptionType = oCondition.option_type;				var tb = $("tbody#body_of_good_condition").get(0);		var trow=document.createElement("TR");		trow.valign="middle";		$(tb).append(trow);		_sClass = $(tb).children("tr").index(trow) % 2 ? 'tableRowEven' : 'tableRowOdd';		var _sClassL = _sClass + "Left";		var _sClassR = _sClass + "Right";		var iCount = parseInt(pf$("input#conditions_count").val());				$(tb).append("<td class='"+_sClassL+"'></td>");		var tcol=document.createElement("TD");		tcol.className = _class;		$(tcol).append("<select id='condition_"+ "and_or" + "_" + iCount + "><option value=''></option><option value='and'>AND</option><option value='or'>OR</option></select>");		if (oCondition.and_or)			$("#condition_"+ "and_or" + "_" + iCount).val(oCondition.and_or);		if (iCount == 0)			$("#condition_"+ "and_or" + "_" + iCount).hide();				var tinput=document.createElement('INPUT'); tinput.type='hidden';		tinput.setAttribute("name",'condition_'+ 'bracket' + '_' + iCount);		tinput.value = _sField;		$(tcol).append(tinput);				$(trow).append(tcol);				tcol=document.createElement("TD");		tcol.className = _class;		$(tcol).append("<select id='condition_"+ "bracket_left" + "_" + iCount + "><option value=''></option><option value='('> ( </option></select>");		$(trow).append(tcol);		if (oCondition.bracket == "(")			$("#condition_"+ "bracket_left" + "_" + iCount).val(oCondition.bracket);		$("#condition_"+ "bracket_left" + "_" + iCount).change(function() {$("#condition_"+ "bracket_right" + "_" + iCount).val(""); $("#condition_"+ "bracket" + "_" + iCount).val("(")} );				tcol=document.createElement("TD");		tcol.className = _class;		tcol.innerHTML = _sTitle + "[" + _sField + "] ";		switch (_sOptionType)		{<%			for (fldOptionType in curLngCommon.all_option_types)			{%>			case "<%=fldOptionType.id%>": tcol.innerHTML += "<%=fldOptionType.name%>"; break;<%			}%>			default: tcol.innerHTML += "???";		}		tcol.innerHTML += " " + _sValue;				tinput=document.createElement('INPUT'); tinput.type='hidden';		tinput.setAttribute("name",'condition_'+ 'field' + '_' + iCount);		tinput.value = _sField;		$(tcol).append(tinput);				tinput=document.createElement('INPUT'); tinput.type='hidden';		tinput.setAttribute("name",'condition_'+ 'field' + '_' + iCount);		tinput.value = _sTitle;		$(tcol).append(tinput);				tinput=document.createElement('INPUT'); tinput.type='hidden';		tinput.setAttribute("name",'condition_'+ 'option_type' + '_' + iCount);		tinput.value = _sOptionType;		$(tcol).append(tinput);						$(trow).append(tcol);				tcol=document.createElement("TD");		tcol.className = _class;		$(tcol).append("<select id='condition_"+ "bracket_right" + "_" + iCount + "><option value=''></option><option value=')'> ) </option></select>");		$(trow).append(tcol);		if (oCondition.bracket == ")")			$("#condition_"+ "bracket_right" + "_" + iCount).val(oCondition.bracket);		$("#condition_"+ "bracket_right" + "_" + iCount).change(function() {$("#condition_"+ "bracket_left" + "_" + iCount).val(""); $("#condition_"+ "bracket" + "_" + iCount).val(")")} );				tcol=document.createElement("TD");		tcol.className = _class;				tinput=document.createElement('INPUT');		tinput.setAttribute("type",'button');		tinput.className="inputButton";		tinput.setAttribute("id",'answer_del_' + iCount);		tinput.setAttribute("name",'answer_del_' + iCount);		tinput.style.width="20px";		tinput.setAttribute("value","X");		tinput.setAttribute("title","<%=tools_web.get_web_str('dcs_del_question')%>");		$(tinput).bind('click', function(e){deleteChild(this);});		$(tinput).hover(function() {$(this).addClass("inputButtonOver")}, function() {$(this).removeClass("inputButtonOver")});		$(tcol).append(tinput);				$(trow).append(tcol);				$(tb).append("<td class='"+_sClassR+"'></td>");		$("div#dynamic_table input#dynamic_conditions_count").val(iCount++);	}		function deleteChild(sourceElem)	{		var parent_tr=sourceElem.parentNode.parentNode;		var tobj=$("tbody#body_of_good_condition").get(0);		tobj.deleteRow(parent_tr.sectionRowIndex);		return true;	}--></script></HEAD><BODY id="body_id"><TABLE CELLPADDING="0" CELLSPACING="3" BORDER="0" WIDTH="100%">	<TR>		<TD>			<table width="100%">				<tr>					<td><%=tools_web.get_web_str('dcs_pers_condition')%></td>					<td><input type="button" value="<%=tools_web.get_web_str('dcs_add_conditions')%>" onClick="" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';"/></td>				</tr>			</table>						<table width="100%"  border="0" cellspacing="0" cellpadding="3">				<tr>					<td class="tableHeaderNoTextLeft"><img src="pics/1blank.gif" width="1" height="1"/></td>					<td class="tableHeaderNoText" width="20px"><img src="pics/1blank.gif" width="1" height="1"/></td>					<td class="tableHeaderNoText" width="20px"><img src="pics/1blank.gif" width="1" height="1"/></td>					<td class="tableHeaderNoText" width="100%"><img src="pics/1blank.gif" width="1" height="1"/></td>					<td class="tableHeaderNoText" width="20px"><img src="pics/1blank.gif" width="1" height="1"/></td>					<td class="tableHeaderNoText" width="20px"><img src="pics/1blank.gif" width="1" height="1"/></td>					<td class="tableHeaderNoRight"><img src="pics/1blank.gif" width="1" height="1"/></td>				</tr>				<tbody id="body_of_good_condition">				</tbody>				<tr>					<td class="tableFooterLeft"><img src="pics/1blank.gif" width="1" height="1" /></td>					<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>					<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>					<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>					<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>					<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>					<td class="tableFooterRight"><img src="pics/1blank.gif" width="1" height="1" /></td>				</tr>			</table>			<input type="hidden" id="conditions_count" value="0"/>		</TD>	</TR></TABLE></BODY></HTML>