<%
	Server.Execute( "include/user_init.html" );

	docPerson = OpenDoc( UrlFromDocID( curUserID ) );
	
	if ( Request.Query.HasProperty( 'lng_id' ) )
		docPerson.TopElem.lng_id = Request.Query.lng_id;
	
	_redirect_url = 'view_doc.html';	
	if ( Request.Query.HasProperty( 'web_design_id' ) )
	{
		docPerson.TopElem.web_design_id = Request.Query.web_design_id;
		curWebDesignUrl = global_settings.settings.web_designs.GetChildByKey( docPerson.TopElem.web_design_id ).url;
		_redirect_url = ( curWebDesignUrl == '' ? '/view_doc.html' : ( StrBegins( curWebDesignUrl, '/' ) ? '' : '/' ) + curWebDesignUrl + ( StrEnds( curWebDesignUrl, '/' ) ? 'view_doc.html' : '/view_doc.html' ) );
	}
	
	docPerson.Save();	
	
	Session.main_blok_cache = undefined;
	Session.news_cache = undefined;
	Session.header_cache = undefined;
	
	Response.Redirect( _redirect_url );
	Cancel();
%>