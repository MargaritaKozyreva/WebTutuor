<%Server.Execute( "include/sid_access_init.html" )%>

<%
	try
	{
		_requestDoc = OpenDoc(UrlFromDocID(Int(Request.Form.object_id)));
	}
	catch(_rrrr_)
	{
		_requestDoc = undefined;
	}
	
	if (_requestDoc != undefined && curUserID == _requestDoc.TopElem.person_id)
	{
		tools.request_rejecting( _requestDoc.DocID, _requestDoc, curUserID );
		
		Response.Redirect( "view_doc.html?mode=requests&doc_id=" + Request.Form.doc_id );
	}
	else
	{
		Response.Redirect( "view_access_panel.html" );
	}

	
%>