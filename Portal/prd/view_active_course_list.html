<%
try
{
	curActiveLearnings;
}
catch ( err )
{
	curActiveLearnings = XQuery( 'for $elem in active_learnings where $elem/person_id = ' + curUserID + ' return $elem' );
}
if ( ArrayOptFirstElem( curActiveLearnings ) != undefined ) 
{
%>
<br/>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
	<tr>
		<td class="tableHeaderTextLeft"><img src="pics/1blank.gif" width="0" height="0"/></td>
		<td class="tableHeaderText" colspan="5"><p class="tableHeaderTextInner"><%=tools.get_web_str('vac_title')%></p></td>
		<td class="tableHeaderTextRight"><img src="pics/1blank.gif" width="0" height="0"/></td>
	</tr>
	<tr>
		<td class="tableHeaderWithTextLeft"><img src="pics/1blank.gif" width="0" height="0"/></td>
		<td class="tableHeaderWithText"><%=tools.get_web_str('c_course')%></td>
		<td class="tableHeaderWithText"><%=tools.get_web_str('c_score')%></td>
		<td class="tableHeaderWithText"><%=tools.get_web_str('c_start_date')%></td>
		<td class="tableHeaderWithText"><%=tools.get_web_str('c_finish_date')%></td>
		<td class="tableHeaderWithText" WIDTH="140"><%=tools.get_web_str('vllb_action')%></td>
		<td class="tableHeaderWithTextRight"><img src="pics/1blank.gif" width="0" height="0"/></td>
	</tr>
	<tr>
		<td class="tableHeaderNoTextLeft"><img src="pics/1blank.gif" width="0" height="0"/></td>
		<td class="tableHeaderNoText" colspan="5"><img src="pics/1blank.gif" width="1" height="1" /></td>
		<td class="tableHeaderNoTextRight"><img src="pics/1blank.gif" width="0" height="0"/></td>
	</tr>
<%
	counter = 0;
	for ( catActiveLearningElem in curActiveLearnings )
	{
		_class  = counter++ % 2 ? 'tableRowEven' : 'tableRowOdd';
		_classl = counter++ % 2 ? 'tableRowEvenLeft' : 'tableRowOddLeft';		
		_classr = counter++ % 2 ? 'tableRowEvenRight' : 'tableRowOddRight';	
%>	
	<tr>
		<td class="<%=_classl%>"></td>
<%
		try
		{
			catCourse = catActiveLearningElem.course_id.ForeignElem;
%>
		<td class="<%=_class%>"><span class="tableRowEven"><a href="view_doc.html?mode=learning_proc&doc_code=active_learnings&course_id=<%=catActiveLearningElem.course_id%>&object_id=<%=catActiveLearningElem.id%>"><%=catCourse.code%>&nbsp;<%=tools_web.get_cur_lng_name( catCourse.name )%></a></span><br/></td>
		<td align="center" class="<%=_class%>"><span class="tableRowEven"></span><%=catActiveLearningElem.score%>&nbsp;<%=( catCourse.max_score == 0 ? '' : '(' + StrReal( ( 100 * catActiveLearningElem.score ) / catCourse.max_score, 1 ) + '%)' )%></span></td>
		<td align="center" class="<%=_class%>"><span class="tableRowEven"><%=StrDate( catActiveLearningElem.start_learning_date, false )%></span></td>
		<td align="center" class="<%=_class%>"><span class="tableRowEven"><%=( catActiveLearningElem.max_end_date.HasValue ? StrDate( catActiveLearningElem.max_end_date, false ) : '-' )%></span></td>
		<td align="center" class="<%=_class%>"><span class="tableRowEven" WIDTH="140">
<%
			if ( ! catActiveLearningElem.start_learning_date.HasValue || catActiveLearningElem.start_learning_date < CurDate )
			{
%>
			<input type="button" value="<%=HtmlEncode( tools.get_web_str('vcorb_b_refr') )%>" class="inputButton" style=" width:140px " onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';" onClick="document.location.href='view_doc.html?mode=learning_proc&object_id=<%=catActiveLearningElem.id%>&course_id=<%=catActiveLearningElem.course_id%>&start=1';return false">
<%
			}
%>
		</span></td>
<%
		}
		catch ( t )
		{
%>
		<td colspan="5" class="<%=_class%>"><span class="tableRowEven"><%=tools.get_web_str('c_deleted')%></span></td>
<%
		}
%>			
		<td class="<%=_classr%>"></td>	
	</tr>
<%
	}
%>	
	<tr>
		<td class="tableFooterLeft"><img src="pics/1blank.gif" width="0" height="0" /></td>
		<td class="tableFooter" colspan="5"><img src="pics/1blank.gif" width="0" height="0" /></td>
		<td class="tableFooterRight"><img src="pics/1blank.gif" width="0" height="0" /></td>
	</tr>
</table>
<%
}
%>