<%
	if (ArrayOptFirstElem(arrImpersonates) != undefined)
	{
%>
		<table cellpadding="3">
			<tr valign="middle">
				<td><%=tools_web.get_web_str("ass_impersonate_notice")%></td>
				<td>
					<select onchange="window.location.href=this.value + '&f_id=' + Math.random();">
						<option <%=(curPersonID == curUserID ? "selected" : "")%> value="<%=tools_web.get_query_string(true, "face_id;f_id")%>face_id="><%=curUser.fullname%></option>
<%
					for (fldImpElem in arrImpersonates)
					{
%>
						<option <%=(curPersonID == fldImpElem.face_person_id ? "selected" : "")%> value="<%=tools_web.get_query_string(true, "face_id;f_id")%>face_id=<%=fldImpElem.face_person_id%>"><%=fldImpElem.face_person_fullname%></option>
<%
					}
%>
					</select>
				</td>
			</tr>
		</table>
<%
	}
%>
<table width="100%" border="0" height="100%">
	<tr valign="top">
<%
	if ( ! curWebCommon.disp_custom_left_panel )
	{
%>
		<td width="200">
			<%Server.Execute( "view_tree_body.html" )%>
		</td>
<%
	}
%>

		<td>
<%
	
	if (curAssessmentAppraise.web_display)
	{
	
		if (curWorkflow == null)
		{			
			Response.Write('<center><font size="+1">' + tools.get_web_str("ass_no_workflow") + '</font><center>');
		}
		else
		{
			if(curAssessmentAppraise.prefix_custom_web_template_id.HasValue)
			{
			
				try
				{
					Response.Write(tools_web.insert_custom_code(curAssessmentAppraise.prefix_custom_web_template_id, null,true,false));
				}
				catch(_oi_)
				{}
			}
			
			try
			{
				curPaID = Int(Request.QueryString.pa_id );

			}
			catch(_fuck_)
			{
				curPaID = null;
			}	
				if (curPaID != null)
				{
					try
					{
						curAssessmentAppraiseType = Request.QueryString.assessment_appraise_type;
					}
					catch(_bullshit_)
					{
						curAssessmentAppraiseType = '';
					}
					
					switch (curAssessmentAppraiseType)
					{
					
						case 'competence_appraisal':
							Server.Execute( "view_competence_body.html" );
							break;
					
						case 'activity_appraisal':
							PLAN = 0;
							Server.Execute( "view_kpi_body.html" );
							break;
							
						case 'activity_plan':
							PLAN = 1;
							Server.Execute( "view_kpi_body.html" );
							break;
					
						case 'development_plan':
							PLAN = 1;
							Server.Execute( "view_development_body.html" );
							break;
		
						case 'result':
							Server.Execute( "view_result_body.html" );
							break;
					
					
						case 'staffrating':
							Server.Execute( "view_staffrating_body.html" );
							break;
					
					}
				}
				else
				{
					try
					{
						curAssessmentPlan = Int(Request.QueryString.assessment_plan_id );
					}
					catch(_fuck_)
					{
						curAssessmentPlan = null;
					}
					
					if (curAssessmentPlan != null)
					{
						Server.Execute( "view_participants_body.html" );
					}
					else
					{
						Response.Write("<div class='text'><center>" + tools_web.get_web_str("ass_empty_page_message") + "</center></div>");
					}
				}
		}
	}
	else
	{
		Response.Write("<center><table border='1' style='border-width: 10px' bordercolor='red' cellspacing='10' cellpadding='5'><tr><td><IMG SRC='pics/atten.jpg'></td><td><font color='maroon' size='+1'>" + tools.get_web_str("vaasb_message1") + "</font></td></tr></table></center>");
	}	
%>
		</td>
	</tr>
</table>