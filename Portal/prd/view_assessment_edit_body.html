<%
	try
	{
		curAssessmentID = Int( Request.QueryString.object_id );
		curAssessment = OpenDoc( UrlFromDocID( curAssessmentID ) ).TopElem;
		//if ( tools.check_access(curAssessment, curUserID) == false ) throw "ne lez!";
	}
	catch(_fuck_)
	{
		curAssessment = null;
		curAssessmentID = null;
	}

	try
	{
		Session.RETURN_MSG;
	}
	catch(_x_)
	{
		Session.RETURN_MSG = "";
	}

	if (Session.RETURN_MSG != "")
	{
		Response.Write("<br/><center><font size='+1' align='center'><i><b>" + HtmlEncode(Session.RETURN_MSG) + "</b></i></font></center>");
		Session.RETURN_MSG = "";
	}
%>

<script language="javascript">
<!--
//------------------------------------------------------------------------------------------
jQuery.fn.moveRow = function(elem, up) {
	var idx = $(elem).parent().parent().get(0).sectionRowIndex;
    var trs = this.children("tr");
	
	var source = trs.eq(idx);
	var dest = trs.eq(idx + (up ? -1: 1));
	
	if (source.length > 0 && dest.length > 0)
	{
		source['insert' + (up ? 'Before': 'After')](dest);
		idx = $(trs).index(source);
		$(source).find(">td").each(function(){this.className = idx % 2 ?  'tableRowOdd' : 'tableRowEven';})
		idx = $(trs).index(dest);
		$(dest).find(">td").each(function(){this.className = idx % 2 ? 'tableRowOdd' : 'tableRowEven';})
	}	
};
function buttonMouseOver()
{
	window.event.srcElement.className='inputButtonOver';
}
function buttonMouseOut()
{
	window.event.srcElement.className='inputButton';
}
//------------------------------------------------------------------------------------------
function checkkey(srcobj, e, flag_flat)
{
	if (!e) var e = window.event;
	var keycode = parseInt(e.keyCode ? e.keyCode : e.which);
	if ((keycode<48 || keycode>57) && keycode!=46) return false;
	if (keycode==46) 
	{
		if( (!flag_flat) || srcobj.value.indexOf('.') >= 0) return false;
	}
	return true;
}

function addItem(cur_id, cur_name, _x, tobj)
{
	var trow=document.createElement("TR");
	trow.setAttribute("id","item_" + cur_id);
	trow.setAttribute("value",cur_id);
	trow.valign="middle";
	$(tobj).append(trow);
	
	_class = $(tobj).children("tr").index(trow) % 2  % 2 ? 'tableRowEven' : 'tableRowOdd';
	
	var tcol1=document.createElement("TD");
	tcol1.className = _class;
	$(trow).append(tcol1);
	
<%
_href = tools_web.get_url_protocol( Request.Url ) + Request.UrlHost + UrlPath( Request.Url ) + "?mode=item_edit&doc_id="+curDocID + "&object_id=";
%>
	tcol1.innerHTML = "<a href='<%=_href%>" +cur_id+ "'>" + cur_name + "</a>";
	
	var tinput_qt=document.createElement('INPUT');
	tinput_qt.type='hidden'; 
	tinput_qt.id='item_id_' + _x;
	tinput_qt.name='item_id_' + _x;
	tinput_qt.value = cur_id;
	$(tcol1).append(tinput_qt);
	
	var tcol3=document.createElement("TD");
	tcol3.width="100px";
	tcol3.className = _class;
	tcol3.align = 'center';
	$(trow).append(tcol3);
	
	var tinput_delbut=document.createElement('INPUT');
	tinput_delbut.type='button'; 
	tinput_delbut.className="inputButton";
	tinput_delbut.id='answer_del_' + cur_id;
	tinput_delbut.name='answer_del_' + cur_id;
	tinput_delbut.style.width="20px";
	tinput_delbut.value="X";
	tinput_delbut.setAttribute("title","<%=tools_web.get_web_str("dcs_del_question")%>");
	tinput_delbut.setAttribute("code", cur_id);
	$(tinput_delbut).bind("click", function(e){deleteChild(this);});
	$(tinput_delbut).hover(function() {$(this).addClass("inputButtonOver")}, function() {$(this).removeClass("inputButtonOver")});
	$(tcol3).append(tinput_delbut);
		
	var tinput_upbut=document.createElement("INPUT");
	tinput_upbut.type="button"; 
	tinput_upbut.className="inputButton";
	tinput_upbut.id="answer_up_" + cur_id;
	tinput_upbut.name="answer_up_" + cur_id;
	tinput_upbut.style.width="20px";
	tinput_upbut.value= String.fromCharCode(0x25B2) ;
	tinput_upbut.setAttribute("title","<%=tools_web.get_web_str("c_move_up")%>");
	tinput_upbut.setAttribute("code", cur_id);
	$(tinput_upbut).click(function(e) {$("tbody#recycler").moveRow(this, true);});
	$(tinput_upbut).hover(function() {$(this).addClass("inputButtonOver")}, function() {$(this).removeClass("inputButtonOver")});
	$(tcol3).append(tinput_upbut);
		
	var tinput_downbut=document.createElement('INPUT');
	tinput_downbut.type='button'; 
	tinput_downbut.className="inputButton";
	tinput_downbut.id='answer_down_' + cur_id;
	tinput_downbut.name='answer_down_' + cur_id;
	tinput_downbut.style.width="20px";
	tinput_downbut.value= String.fromCharCode(0x25BC) ;
	tinput_downbut.setAttribute("title","<%=tools_web.get_web_str("c_move_down")%>");
	tinput_downbut.setAttribute("code", cur_id);
	$(tinput_downbut).click(function(e) {$("tbody#recycler").moveRow(this, false);});
	$(tinput_downbut).hover(function() {$(this).addClass("inputButtonOver");}, function() {$(this).removeClass("inputButtonOver")});
	$(tcol3).append(tinput_downbut);
}

function addItems()
{
	var tobj = document.getElementById("recycler");
	var item_count = parseInt(document.getElementById("item_count").value);
	
	var pars=new Object();
	var _x = 0;
	pars.selected_object_ids = "";
	while (_x < item_count)
	{
		if (document.getElementById("item_id_" + _x) != undefined)
			pars.selected_object_ids += (pars.selected_object_ids != "" ? ";" : "") + document.getElementById("item_id_" + _x).value;
		_x++;
	}
			
	var strAttr="status:no;dialogWidth:780px;dialogHeight:550px;help:no;resizable:1";
<%
	_itemCardDoc = tools_web.get_my_person_object_link_card("item",curUserID);

	if (_itemCardDoc != undefined)
		_item_allowed_pack = ArrayMerge(_itemCardDoc.objects, "This.PrimaryKey",";");
	else
		_item_allowed_pack = Array();
%>
	pars.display_object_ids = "<%=_item_allowed_pack%>";
	if (pars.display_object_ids == "") pars.display_object_ids = "0";
	
	xShowModalDialog("dlg_select.html?doc_id=<%=curDocID%>&catalog_name=item&typein=0&multi_select=1&rand="+Math.random(), pars, strAttr);
	
	if (!pars.handle) return false;
	
	for (var i = tobj.rows.length - 1; i >= 0; i--)
	{
		_x = tobj.rows[i].sectionRowIndex;
		tobj.deleteRow(_x);
	}
	item_count = 0;
	
	for (_x = item_count; _x < pars.elemArray.length; _x++)
	{
		var cur_id = pars.elemArray[_x];
		var cur_name = pars.elemNamesArray[_x];
		
		addItem(cur_id, cur_name, _x, tobj)
		item_count++;
	}
	document.getElementById("item_count").value = item_count;
}
function deleteChild()
{
	var parent_tr=event.srcElement.parentNode.parentNode;
	var tobj=document.all.recycler;
	tobj.deleteRow(parent_tr.sectionRowIndex);
	return true;
}

function what2submit()
{
	var tobj=document.all.recycler;
	var item_count = parseInt(document.getElementById("item_count").value);
		
	if (document.getElementById("code").value == "")
	{
		window.alert(<%=CodeLiteral( tools_web.get_web_str("vaeb_mess_empty_code") )%>);
		return false;
	}
	if (document.getElementById("title").value == "")
	{
		window.alert(<%=CodeLiteral( tools_web.get_web_str("vaeb_mess_empty_title") )%>);
		return false;
	}
	var ans_list = "";
	var _x = 0;
	while (_x < item_count)
	{
		if (document.getElementById("item_id_" + _x) != undefined)
			ans_list += (ans_list != "" ? ";" : "") + document.getElementById("item_id_" + _x).value;
		_x++;
	}
	
	if(ans_list == "")
	if (!confirm(<%=CodeLiteral( tools_web.get_web_str("vaeb_mess_empty_questions") )%>)) return false;
	
	var tinput=document.createElement('INPUT');
	tinput.type='hidden'; 
	tinput.name='item_ids';
	tinput.value = ans_list;
	$(tobj).append(tinput);
	
	return true;
}
-->
</script>

<!--
<input type="button" onclick="debuggg()" value="DeBuG!" style="font-family:Wingdings" class="inputButton"/>
-->

<table width="100%"  border="0" cellspacing="0" cellpadding="3" name="top_report_table">
<tr>
<td>

<form name="assessment_submitter" id="assessment_submitter" action="content_panel_process.html" method="post">
<input type="hidden" name="assessment_id" value="<%=(curAssessmentID != null ? curAssessmentID : 0)%>"/>
<input type="hidden" name="mode" value="assessment"/>
<input type="hidden" name="doc_id" value="<%=curDocID%>"/>
<input type="hidden" name="href" value="<%=Request.Url%>"/>

<table width="100%" cellspacing="0" cellpadding="4" class="tableBorder" border="0">
	<tr>
		<td style="font-weight:bolder; font-size:larger;" width="90px"><%=tools_web.get_web_str("c_code")%>:</td>
		<td style="font-weight:bolder; font-size:larger"><input type="text" id="code" name="code" value="<%=(curAssessment != null ? HtmlEncode(curAssessment.code) : tools.random_string(6))%>" class="inputEdit" style="width:100%"/></td>
	</tr>
	<tr>
		<td style="font-weight:bolder; font-size:larger;" width="90px"><%=tools_web.get_web_str("c_title")%>:</td>
		<td style="font-weight:bolder; font-size:larger"><input type="text" id="title" name="title" value="<%=(curAssessment != null ? HtmlEncode(curAssessment.title) : "")%>" class="inputEdit" style="width:100%"/></td>
	</tr>
</table>
<br/>
<table width="100%">
	<tr>
		<td style="font-weight:bolder; width: 100px"><%=tools_web.get_web_str("c_second_duration")%>:</td><td><input type="text" id="duration" name="duration" value="<%=(curAssessment != null ? curAssessment.duration : "")%>" class="inputEdit" style="width:100px" onkeypress="return checkkey(this,event, false);" onblur="return checkkey(this,event, false);"/></td>
		<td style="font-weight:bolder; width: 110px"><%=tools.get_web_str("c_pass_score")%>:</td><td><input type="text" id="passing_score" name="passing_score" value="<%=(curAssessment != null ? curAssessment.passing_score : "")%>" class="inputEdit" style="width:100px" onkeypress="return checkkey(this,event, false);" onblur="return checkkey(this,event, false);"/></td>
		<td style="font-weight:bolder; width: 130px"><%=tools.get_web_str("c_attempt_num")%>:</td><td><input type="text" id="attempts_num" name="attempts_num" value="<%=(curAssessment != null ? curAssessment.attempts_num : "")%>" class="inputEdit" style="width:100px" onkeypress="return checkkey(this,event, false);" onblur="return checkkey(this,event, false);"/></td>
	</tr>
</table>
<table width="100%" cellspacing="0" cellpadding="4" class="tableBorder" border="0">
	<tr>
		<td style="font-weight:bolder; font-size:larger;" width="350px"><%=tools_web.get_web_str("vaeb_feedback_wrong")%></td>
		<td style="font-weight:bolder; font-size:larger"><textarea id="feedback_wrong" name="feedback_wrong" style="width:90%"><%=(curAssessment != null ? curAssessment.feedback_wrong : "")%></textarea></td>
	</tr>
	<tr>
		<td style="font-weight:bolder; font-size:larger;"><%=tools_web.get_web_str("vaeb_feedback_correct")%></td>
		<td style="font-weight:bolder; font-size:larger"><textarea id="feedback_correct" name="feedback_correct" style="width:90%"><%=(curAssessment != null ? curAssessment.feedback_correct : "")%></textarea></td>
	</tr>
	<tr>
		<td style="font-weight:bolder; font-size:larger;"><%=tools_web.get_web_str("vaeb_feedback_passed")%></td>
		<td style="font-weight:bolder; font-size:larger"><textarea id="feedback_passed" name="feedback_passed" style="width:90%"><%=(curAssessment != null ? curAssessment.feedback_passed : "")%></textarea></td>
	</tr>
	<tr>
		<td style="font-weight:bolder; font-size:larger;"><%=tools_web.get_web_str("vaeb_feedback_failed")%></td>
		<td style="font-weight:bolder; font-size:larger"><textarea id="feedback_failed" name="feedback_failed" style="width:90%"><%=(curAssessment != null ? curAssessment.feedback_failed : "")%></textarea></td>
	</tr>
</table>
<br/>

<table style="font-weight:bolder; font-size:larger;">
	<tr>
		<td width="150"><%=tools_web.get_web_str("vaeb_player_lng")%>:</td>
		<td width="300">
			<select name="language" id="language" style="width: 90%">
				<%
					for (_lng in common.player_languages) Response.Write("<option "+((curAssessment != null && curAssessment.player.language == _lng.PrimaryKey)||(curAssessment == null && _lng.PrimaryKey == "ru") ? "selected": "")+" value='"+_lng.PrimaryKey+"'>" +_lng.name+"</option>");
				%>
			</select>
		</td>
		<td width="300"><%=tools_web.get_web_str("vaeb_data_post_timeout")%>:</td>
		<td width="300">
			<select name="send_type" id="send_type" style="width: 90%">
				<%
					for (_lng in common.player_send_types) Response.Write("<option "+((curAssessment != null && curAssessment.player.send_type == _lng.PrimaryKey)||(curAssessment == null && _lng.PrimaryKey == "q") ? "selected": "")+" value='"+_lng.PrimaryKey+"'>" +_lng.name+"</option>");
				%>
			</select>
		</td>
	</tr>
	<tr>
		<td><%=tools_web.get_web_str("vaeb_view_type")%>:</td>
		<td>
			<select name="display_type" id="display_type" style="width: 90%">
				<%
					for (_lng in common.player_display_types) Response.Write("<option "+((curAssessment != null && curAssessment.player.display_type == _lng.PrimaryKey)||(curAssessment == null && _lng.PrimaryKey == "item") ? "selected": "")+" value='"+_lng.PrimaryKey+"'>" +_lng.name+"</option>");
				%>
			</select>
		</td>
		<td><%=tools_web.get_web_str("vaeb_view_desc")%>:</td>
		<td>
			<select name="rubric_display_type" id="rubric_display_type" style="width: 90%">
				<%
					for (_lng in common.player_rubric_display_types) Response.Write("<option "+((curAssessment != null && curAssessment.player.rubric_display_type == _lng.PrimaryKey)||(curAssessment == null && _lng.PrimaryKey == "none") ? "selected": "")+" value='"+_lng.PrimaryKey+"'>" +_lng.name+"</option>");
				%>
			</select>
		</td>
	</tr>
	<tr>
		<td colspan="2"><input type="checkbox" name="display_map" id="display_map" <%=(curAssessment == null || curAssessment.player.display_map ? "checked": "")%> value="1"/><%=tools_web.get_web_str("vaeb_show_map")%></td>
		<td colspan="2"><input type="checkbox" name="navigate_map" id="navigate_map" <%=(curAssessment == null || curAssessment.player.navigate_map ? "checked": "")%> value="1"/><%=tools_web.get_web_str("vaeb_can_move")%></td>
	</tr>
	<tr>
		<td colspan="2"><input type="checkbox" name="strict_navigation" id="strict_navigation" <%=(curAssessment == null || curAssessment.player.strict_navigation ? "checked": "")%> value="1"/><%=tools_web.get_web_str("vaeb_wrong_navig")%></td>
		<td colspan="2"><input type="checkbox" name="navigate_progress" id="navigate_progress" <%=(curAssessment == null || curAssessment.player.navigate_progress ? "checked": "")%> value="1"/><%=tools_web.get_web_str("vaeb_can_move_ind")%></td>
	</tr>
	<tr>
		<td colspan="2"><input type="checkbox" name="strict_timing" id="strict_timing" <%=(curAssessment == null || curAssessment.player.strict_timing ? "checked": "")%> value="1"/><%=tools_web.get_web_str("vaeb_time_not_stop")%></td>
		<td colspan="2"><input type="checkbox" name="accept_next" id="accept_next" <%=(curAssessment == null || curAssessment.player.accept_next ? "checked": "")%> value="1"/><%=tools_web.get_web_str("vaeb_ans_and_go")%></td>
	</tr>
	<tr>
		<td colspan="2"><input type="checkbox" name="lock_result" id="lock_result" <%=(curAssessment != null && curAssessment.player.lock_result ? "checked": "")%> value="1"/><%=tools_web.get_web_str("vaeb_not_move")%></td>
		<td colspan="2"><input type="checkbox" name="connection_break" id="connection_break" <%=(curAssessment != null && curAssessment.player.connection_break ? "checked": "")%> value="1"/><%=tools_web.get_web_str("vaeb_connect_stop")%></td>
	</tr>
</table>
<br/>
<%
	_items = Array();
	_section = undefined;
	_select_id = "all";
	if (curAssessment != null)
	{
		_section = ArrayOptFirstElem(curAssessment.sections);
		if (_section != undefined)
		{
			_items = _section.items;
			if (_section.selection_ordering.select_id.HasValue)
				_select_id = _section.selection_ordering.select_id;
		}
	}
%>
<table width="100%" cellspacing="0" cellpadding="4" class="tableBorder" border="0">
	<tr>
		<td style="font-weight:bolder; font-size:larger;" width="350px"><%=tools_web.get_web_str("vaeb_sel_quest_type")%></td>
		<td style="font-weight:bolder; font-size:larger">
			<select id="select_id" name="select_id" onchange="
				if (this.value == 'num_generate') document.getElementById('tr_num_generate').style.display = 'inline';
				else document.getElementById('tr_num_generate').style.display = 'none';
				
				if (this.value == 'point') document.getElementById('tr_point').style.display = 'inline';
				else document.getElementById('tr_point').style.display = 'none';
			">
				<option <%=(_select_id == "all" ? "selected": "")%> value="all"><%=tools_web.get_web_str("c_all")%></option>
				<option <%=(_select_id == "num_generate"  ? "selected": "")%> value="num_generate"><%=tools_web.get_web_str("vaeb_by_quest_num")%></option>
				<option <%=(_select_id == "point"  ? "selected": "")%> value="point"><%=tools_web.get_web_str("vaeb_by_quest_score")%></option>
			</select>
		</td>
	</tr>
	<tr id="tr_num_generate" style="display: <%=(_select_id == "num_generate"  ? "inline": "none")%>">
		<td style="font-weight:bolder; font-size:larger;" width="350px"><%=tools_web.get_web_str("vaeb_sel_quest_type")%></td>
		<td style="font-weight:bolder; font-size:larger">
			<input type="text" id="select_num" name="select_num" class="inputEdit" value="<%=(_section != undefined ? _section.selection_ordering.select_num : "")%>" style="width:50" onkeypress="return checkkey(this,event, false);" onblur="if (isNaN(parseInt(this.value))) this.value=0; else this.value = parseInt(this.value);"/>
		</td>
	</tr>
	<tr id="tr_point" style="display: <%=(_select_id == "point"  ? "inline": "none")%>">
		<td style="font-weight:bolder; font-size:larger;">&nbsp;</td>
		<td style="font-weight:bolder; font-size:larger">
			<table cellspacing="0" id="pointer_table">
				<tr><th width="100px"><%=tools_web.get_web_str("ques_score")%></th><th width="100px"><%=tools_web.get_web_str("c_num")%></th></tr>
				<%
					_x=0;
					if (_section != undefined)
					for (_point in _section.selection_ordering.points)
					{
						if (_point.point_num.HasValue && _point.item_num.HasValue)
						{
				%>
					<tr>
						<td align="center"><input type="text" id="point_num_<%=_x%>" name="point_num_<%=_x%>" class="inputEdit" value="<%=_point.point_num%>" style="width:50" onkeypress="return checkkey(this,window.event.keyCode, false);" onblur="if (isNaN(parseInt(this.value))) this.value=''; else this.value = parseInt(this.value); check_point_row(<%=_x%>)"/></td>
						<td align="center"><input type="text" id="item_num_<%=_x%>" name="item_num_<%=_x%>" class="inputEdit" value="<%=_point.item_num%>" style="width:50" onkeypress="return checkkey(this,window.event.keyCode, false);" onblur="if (isNaN(parseInt(this.value))) this.value=''; else this.value = parseInt(this.value); check_point_row(<%=_x%>)"/></td>
					</tr>
				<%
							_x++;
						}
					}
				%>
					<tr>
						<td align="center"><input type="text" id="point_num_<%=_x%>" name="point_num_<%=_x%>" class="inputEdit" value="" style="width:50" onkeypress="return checkkey(this,window.event.keyCode, false);" onblur="if (isNaN(parseInt(this.value))) this.value=''; else this.value = parseInt(this.value); check_point_row(<%=_x%>)"/></td>
						<td align="center"><input type="text" id="item_num_<%=_x%>" name="item_num_<%=_x%>" class="inputEdit" value="" style="width:50" onkeypress="return checkkey(this,window.event.keyCode, false);" onblur="if (isNaN(parseInt(this.value))) this.value=''; else this.value = parseInt(this.value); check_point_row(<%=_x%>)"/></td>
					</tr>
					<input type="hidden" name="point_counter" id="point_counter" value="<%=_x++%>"/>
			</table>
			<script language="javascript">
				function check_point_row(_x)
				{
					var _pn = document.getElementById("point_num_" + _x);
					var _in = document.getElementById("item_num_" + _x);
					var _pc = document.getElementById("point_counter");
					var _counter = parseInt(_pc.value);
					
					if (_pn.value == "" && _in.value == "")
					{
						if (_x + 1 < _counter)
							document.getElementById("pointer_table").deleteRow(_pn.parentNode.parentNode.rowIndex);
					}
					else if (_x + 1 == _counter)
					{
						
						var _tr = document.getElementById("pointer_table").insertRow();
						var _td = document.createElement("TD");
						_td.align = "center";
						_td.innerHTML = '<input type="text" id="point_num_'+_counter+'" name="point_num_'+_counter+'" class="inputEdit" value="" style="width:50" onkeypress="return checkkey(this,window.event.keyCode, false);" onblur="if (isNaN(parseInt(this.value))) this.value=\'\'; else this.value = parseInt(this.value); check_point_row('+_counter+');"/>';
						$(_tr).append(_td);
						
						_td = document.createElement("TD");
						_td.align = "center";
						_td.innerHTML = '<input type="text" id="item_num_'+_counter+'" name="item_num_'+_counter+'" class="inputEdit" value="" style="width:50" onkeypress="return checkkey(this,window.event.keyCode, false);" onblur="if (isNaN(parseInt(this.value))) this.value=\'\'; else this.value = parseInt(this.value); check_point_row('+_counter+');"/>';
						$(_tr).append(_td);
						
						_pc.value = _counter + 1;
					}
				}
			</script>
		</td>
	</tr>
	
	
	
</table>


	<p>
		<input type="button" value="<%=tools_web.get_web_str("vaeb_add_questions")%>" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';" onclick="addItems()"/>
		<input type="hidden" id="answers_count" value="0"/>
	</p>
	
	
	<table width="100%"  border="0" cellspacing="0" cellpadding="3">
		<tr id="line_head">
			<td class="tableHeaderWithText"><%=tools.get_web_str("c_question")%></td>
			<td class="tableHeaderWithText" width="100px">#</td>
		</tr>
		<tr>
			<td class="tableHeaderNoText" colspan="3"><img src="pics/1blank.gif" width="1" height="1"/></td>
		</tr>
		<tbody id="recycler">
			
		</tbody>
		<tr>
			<td colspan="3" class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
		</tr>
	</table>
<%
	if (ArrayOptFirstElem(_items) != undefined)
	{
%>
		<script language='javascript'>
			var tobj1 = document.getElementById("recycler");
<%
		_x = 0;
		for (_item in _items)
		{
			Response.Write('addItem("' + _item.PrimaryKey + '", "' +HtmlEncode(_item.title)+ '", '+_x+', tobj1);');
			_x++;
		}
%>
		</script>
<%
	}
%>
<br/>
<table style="font-weight:bolder; font-size:larger;" width="100%">
	<tr>
		<td><%=tools.get_web_str("c_desc")%></td>
	</tr><tr>
		<td><textarea id="rubric_candidate" name="rubric_candidate" style="width:90%"><%=(curAssessment != null ? HtmlEncode(curAssessment.rubric.candidate) : "")%></textarea></td>
	</tr>
</table>
	
	<input type="hidden" name="item_count" id="item_count" value="<%=ArrayCount(_items)%>"/>
	<br/>
		<center><input type="submit" value="<%=tools.get_web_str("c_save")%>" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';" onclick="return what2submit();"/></center>
</form>
<%
	_href = tools_web.get_url_protocol( Request.Url ) + Request.UrlHost + UrlPath( Request.Url ) + "?mode=content_panel&doc_id="+curDocID+"&tab=assessment";
%>
<center><input type="button" value="<%=tools_web.get_web_str("vaaeb_list_back")%>" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';" onclick="window.location.href='<%=_href%>'"/></center>
<br/>
<%
	Server.Execute("view_knowledge_parts_base.html");
%>
</td>
</tr>
<tr>
	<td colspan="3" class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
</tr>
</table>
