<%
try
{
	curBannerArray;
}
catch ( e )
{
	curBannerArray = ArraySelect( banners, 'true' );
}
curBannerArrayNum = ArrayCount( curBannerArray );

if ( curBannerArrayNum != 0 )	
{
	curBanner = curBannerArray[ Random( 0, curBannerArrayNum - 1 ) ];
	if ( curBanner.type != 'img' )
	{
		curBannerID = curBanner.id;
		curBanner = OpenDoc( UrlFromDocID( curBannerID ) ).TopElem;
	}
%>

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
    <TD ALIGN="CENTER">
<%
		switch ( curBanner.type )
		{
			case 'img':
%>
		<a HREF="<%=curBanner.url%>"><IMG ALT="<%=tools_web.get_cur_lng_name( curBanner.name )%>" BORDER="0" SRC="<%=curBanner.img_url%>"></a>
<%
				break;
				
			case 'html':
				Response.Write( curBanner.html_text );
				break;
				
			case 'rich':
				Response.Write( tools_web.get_web_desc( curBanner.desc, UrlFromDocID( curBannerID ), 'banner.desc' ) );
				break;
		}
%>
	</TD>
</TR>
</TABLE>
<BR>

<%
}
%>