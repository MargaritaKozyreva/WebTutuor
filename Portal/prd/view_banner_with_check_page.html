<%
try
{
	curBannerArray;
}
catch ( e )
{
	curBannerArray = ArraySelect( banners, 'true' );
}
curBannerArrayNum = ArrayCount( curBannerArray );

if ( curBannerArrayNum )	
{
	try
	{
		curDisplayedBanners;
	}
	catch ( ee )
	{
		curDisplayedBanners = Array();
	}
	_dblen = ArrayCount( curDisplayedBanners );
	
	if ( _dblen < curBannerArrayNum )
	{
		_counter_flag = 0;
		do
		{
			_exists_flag = false;
			curBanner = curBannerArray[ Random( 0, curBannerArrayNum - 1 ) ];
			
			for ( _baner_id in curDisplayedBanners )
				if ( _baner_id == curBanner.id )
				{
					_exists_flag = true;
					break;
				}
				
			_counter_flag++;
		}
		while ( _counter_flag < 40 && _exists_flag )
		
		if ( _counter_flag < 40 )
			curDisplayedBanners[ _dblen ] = curBanner.id;
			
		if ( curBanner.type != 'img' )
		{
			curBannerID = curBanner.id;
			curBanner = OpenDoc( UrlFromDocID( curBanner.id ) ).banner;
		}
%>

<table width="100%" border="0" cellspacing="0" cellpadding="0">
	<tr>
		<td align="CENTER">
<%
		switch ( curBanner.type )
		{
			case 'img':
%>
			<a HREF="<%=curBanner.url%>"><IMG ALT="<%=tools_web.get_cur_lng_name( curBanner.name )%>" BORDER="0" SRC="<%=curBanner.img_url%>"></a>
<%
				break;
				
			case 'html':
				Response.Write( curBanner.html_text );
				break;
				
			case 'rich':
				Response.Write( tools_web.get_web_desc( curBanner.desc, UrlFromDocID( curBannerID ), 'banner.desc' ) );
				break;
		}
%>
		</TD>
	</tr>
</table>
<br>

<%
	}
}
%>