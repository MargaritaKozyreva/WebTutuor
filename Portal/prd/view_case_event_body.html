<table width="100%"  border="0" cellspacing="0" cellpadding="0">
<table width="100%"  border="0" cellspacing="0" cellpadding="0">
<tr valign="top">
<td>

<%
if ( curObject.status_id == 'active' && _view )
{
%>


		
	<table width="100%"  border="0" cellspacing="3" cellpadding="0">
<%
if ( curObject.use_video )
{
%>		
		<tr>
		<td>
			
<script>
<!--
var fx = 4;
var fxmax = 12;
var fk = 20;
var wmp_width = 160;
var wmp_height = 120;
var wh = 0.75;

function less_min(){	
		fx = 0;
		resizewmp();
}
function less(){	
	if (fx > 0){
		fx--;
		resizewmp();		
	}
}
function more(){
	if (fx < fxmax){
		fx++;
		resizewmp();		
	}
}
function more_max(){			
		fx = fxmax;	
		resizewmp();	
}
function resizewmp(){
	wmpw = fk * fx + wmp_width;
	wmph = wmpw * wh + 70;
	document["WMP"].width = wmpw;
	document["WMP"].height = wmph;			

}
//-->
</script>		
<table border="0" cellpadding=0 cellspacing=0 width="100%" class="tableBorder">
	<tr><td><%=tools.get_web_str('veb_video_title')%></td></tr>
	<tr>
    <td align=center>
	<object name='WMP' id='WMP' width='240' height='250' 
		classid='CLSID:22D6F312-B0F6-11D0-94AB-0080C74C7E95' 
		codebase='http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=6,4,7,1112' 
		standby='Loading Microsoft® Windows® Media Player components...'      
		type='application/x-oleobject' style="borderWidth='0.5cm'; borderBottomStyle='groove'">
  <param name='Filename' value='<%=curObject.video_url%>' />
  <param name='ShowControls' value='TRUE' />
  <param name='ShowStatusBar' value='true' />
  <param name='Autosize' value='false' />
  <param name='Autostart' value='false' />
  <param name='ShowPositionControls' value='false' />
  <param name='ShowTracker' value='True' />
  <embed type='application/x-mplayer2'
			pluginspage = 'http://www.microsoft.com/Windows/MediaPlayer/'
			src='<%=curObject.video_url%>'
			name='WMP'
			width='245'
			height='240'
			autostart='true'
			showcontrols='' showstatusbar='' showdisplay=''> </embed>
</object>
		<!--HEIGHT='250' WIDTH='240'--></td>
    </tr>

	<tr>
		<td style="text-align: center; font-family: verdana; font-size: 11">
				<a href="#" onclick="less_min();return false;"><img src="/pics/less_min1.png" alt="<%=tools.get_web_str('veb_video_tip1')%>" title="<%=tools.get_web_str('veb_video_tip1')%>" border=0></a>
				<a href="#" onclick="less();return false;"><img src="/pics/less1.png" alt="<%=tools.get_web_str('veb_video_tip2')%>" title="<%=tools.get_web_str('veb_video_tip2')%>" border=0></a>
				<a href="#" onclick="more();return false;"><img src="/pics/more1.png" alt="<%=tools.get_web_str('veb_video_tip3')%>" title="<%=tools.get_web_str('veb_video_tip3')%>" border=0></a>
				<a href="#" onclick="more_max();return false;"><img src="/pics/more_max1.png" alt="<%=tools.get_web_str('veb_video_tip4')%>" title="<%=tools.get_web_str('veb_video_tip4')%>" border=0></a>
		</td>
	</tr>
</table>
			
			</td>
			</tr>
<%
}

if ( curObject.use_audio )
{
%>			
			<tr>
			<td>
<table border="0" cellpadding=0 cellspacing=0 width="100%" height="100%" class="tableBorder">
	<tr>
    <td>			
<%=tools.get_web_str('veb_audio_title')%>
<br>
<center>
<input type="button" style="width: 180px;" value="<%=tools.get_web_str('veb_audio_open')%>" onClick="window.location.href='<% Response.Write( curObject.audio_url + ( StrEnds( curObject.audio_url, '/' ) ? '' : '/' ) + 'nickname=' + UrlEncode( curUser.login ) + '?loginname=' + UrlEncode( curObject.audio_login ) + '?password=' + UrlEncode( curObject.audio_password ) + '?channel=' + UrlEncode( curObject.audio_channel_login ) + '?channelpassword=' + UrlEncode( curObject.audio_channel_password ) ) %>'" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';">
</center>
<br/>
		</td>
	</tr>
</table>			
			</td>
			</tr>
<%
}
%>

		</table>
		
		
		
<%
}
%>



</td>	
<td>	
		
		
		
			
<table border="0" cellpadding="0" cellspacing="3" width="100%" height="100%">



<%
if ( curObject.main_material_url != '' && _view )
{
%>
<script>
function changeSrc() {
if(!document.getElementById("tSrc")) return false;
if(!document.getElementById("tFrame")) return false;
if(document.getElementById("tSrc").value=="") return false;
var s = document.createElement("a");
s.setAttribute("target","tFrame");
s.setAttribute("href",document.getElementById("tSrc").value);
var t = document.createTextNode("Display material");
s.appendChild(t);
if(document.getElementById("FileFromDisc").firstChild!=null) document.getElementById("FileFromDisc").removeChild(document.getElementById("FileFromDisc").firstChild);
document.getElementById("FileFromDisc").appendChild(s);
document.getElementById("FileFromDisc").setAttribute("ref",document.getElementById("tSrc").value);
document.getElementById("FileFromDisc").onclick = function() {
//	document.getElementById("tFrame").src = this.ref;
window.open("win1",this.ref);
	return false;
}

return true;
}

function changeSrcOld() {
if(!document.getElementById("tSrc")) return false;
if(!document.getElementById("tFrame")) return false;
if(document.getElementById("tSrc").value=="") return false;
document.getElementById("tFrame").src = document.getElementById("tSrc").value;
return true;
}
function isSpdBrwsr(){
	var InternetExplorer = navigator.appName.indexOf("Microsoft") != -1;
	return(InternetExplorer ? true : false);
}
</script>
<tr>
<td>
	
	<table width="100%"  border="0" cellspacing="0" cellpadding="3" CLASS="tableBorder">
		<tr>
			<td align="center">
			<iframe id="tFrame" name="tFrame" src="<%=curObject.main_material_url%>" width="<%=curObject.main_material_width%>" height="<%=curObject.main_material_height%>" scrolling="auto" FRAMEBORDER="0"  CLASS="">
			</iframe>
			</td>
		</tr>
		<tr>
			<td ALIGN="LEFT">
			<%=tools.get_web_str('veb_mat_text1')%>&nbsp;</b><input type="file" id="tSrc" name="tSrc" onChange="changeSrc();" CLASS="inputEdit" size="50">
			<div id="FileFromDisc"></div>
			</td>
		</tr>
	
	</table>

</td>
</tr>
<%
}

%>
<%
if ( curObject.forum_id.HasValue && _view )
{
%>
<tr>
<td>

	<br/>
	<br/>
	<a href="#event_forum" onclick="disp_block('event_forum_div','event_forum_img'); return false;" id="event_forum"><p class="headerText" style="margin-top:10px; margin-bottom:10px;"><img src="pics/minus.jpg" id="event_forum_img" border="0"/>&nbsp;<%=tools.get_web_str('c_forum')%></p></a>
	<div id="event_forum_div" style="display: inline">

	<table width="100%"  border="0" cellspacing="0" cellpadding="0" CLASS="tableBorder">
		<tr>
			<td align="left">
				<!-- <iframe src="view_forum_body.html?object_id=<%=curObject.forum_id%>&noheader=" width="100%" height="300" scrolling="auto" FRAMEBORDER="0"></iframe> -->
				<%
					_forum_cat = curObject.forum_id.OptForeignElem;
				%>
				<a href="view_doc.html?mode=forums&object_id=<%=curObject.forum_id%>&doc_id=<%=curDocID%>"><%=(_forum_cat != undefined ? _forum_cat.name : "*" + tools.get_web_str('c_deleted') + "*")%></a>
			</td>
		</tr>
	</table>

</td>
</tr>
<%
}
%>
<SCRIPT LANGUAGE="JAVASCRIPT">
var aTimer;
var per_win;
function refr()
{
	clearTimeout( aTimer );
	
	if( per_win.closed )
	{
		document.location.reload();
		return;
	}
	
	aTimer = setTimeout( 'refr()', 3000 );
}

function doSubmit( _action, _id )
{
	document.forms['event_form'].action.value = _action;
	document.forms['event_form'].selected_object_id.value = _id;

	switch ( _action )
	{	
<%
	if ( _write )
	{
%>	
		case 'delete':
			if ( ! confirm( "<%=tools.get_web_str('veb_message4')%>" ) )
				return false;
			break;
			
		case 'change_tutors':
			var pars=new Object();
			var strAttr="status:no;dialogWidth:780px;dialogHeight:550px;help:no;resizable:1";
<%
	_str = '';
	for ( _elem in curObject.tutors )
		_str = _str + _elem.PrimaryKey + ';';
%>
			pars.selected_object_ids = '<%=_str%>';
			
			xShowModalDialog('dlg_select.html?doc_id=<%=curDocID%>&catalog_name=collaborator&typein=0&multi_select=1&rand='+Math.random(), pars, strAttr);
			if ( ! pars.handle ) 
				return null;
			
			document.forms['event_form'].selected_object_ids.value = pars.selected_object_ids;
			break;
			
		case 'activate_test':
			var pars=new Object();
			pars.xquery_qual = "status='publish'";
			var strAttr="status:no;dialogWidth:780px;dialogHeight:550px;help:no;resizable:1";
			
			xShowModalDialog('dlg_select.html?doc_id=<%=curDocID%>&catalog_name=assessment&typein=0&multi_select=0&rand='+Math.random(), pars, strAttr);
			if ( ! pars.handle ) 
				return null;
			
			document.forms['event_form'].selected_object_id.value = pars.element_id;
			break;
			
		case 'change_lectors':
			var pars=new Object();
			var strAttr="status:no;dialogWidth:780px;dialogHeight:550px;help:no;resizable:1";
<%
	_str = '';
	for ( _elem in curObject.lectors )
		_str = _str + _elem.PrimaryKey + ';';
%>
			pars.selected_object_ids = '<%=_str%>';
			
			xShowModalDialog('dlg_select.html?doc_id=<%=curDocID%>&catalog_name=lector&typein=0&multi_select=0&rand='+Math.random(), pars, strAttr);
			if ( ! pars.handle ) 
				return null;
			
			document.forms['event_form'].selected_object_ids.value = pars.selected_object_ids;
			break;
			
		case 'add_preparation':
			var pars=new Object();
			var strAttr="status:no;dialogWidth:780px;dialogHeight:550px;help:no;resizable:1";

			pars.selected_object_ids = '<%=_str%>';
			
			xShowModalDialog('dlg_select.html?doc_id=<%=curDocID%>&catalog_name=collaborator&typein=0&multi_select=0&rand='+Math.random(), pars, strAttr);
			if ( ! pars.handle ) 
				return null;
			
			document.forms['event_form'].selected_object_id.value = pars.element_id;
			break;
			
		case 'change_collaborators':
			var pars=new Object();
			var strAttr="status:no;dialogWidth:780px;dialogHeight:550px;help:no;resizable:1";
<%
	_str = '';
	for ( _elem in curObject.collaborators )
		_str = _str + _elem.PrimaryKey + ';';
%>
			pars.selected_object_ids = '<%=_str%>';
			
			xShowModalDialog('dlg_select.html?doc_id=<%=curDocID%>&catalog_name=collaborator&typein=0&multi_select=1&rand='+ Math.random(), pars, strAttr);
			if ( ! pars.handle ) 
				return null;
			
			document.forms['event_form'].selected_object_ids.value = pars.selected_object_ids;
			break;
		
		case 'add_collaborator':
			document.forms['event_form'].new_object_id.value = _id;
 			break;

<%
	}

	if ( _requester )
	{
		_str = ';';
		for ( _elem in curObject.collaborators )
			_str = _str + _elem.PrimaryKey + ';';
%>			
		case 'replace_collaborator':
			var pars=new Object();
			var strAttr="status:no;dialogWidth:700px;dialogHeight:550px;help:no;resizable:1";
			
			xShowModalDialog('dlg_select.html?doc_id=<%=curDocID%>&catalog_name=collaborator&typein=0&multi_select=0&rand='+ Math.random(), pars, strAttr);
			if ( ! pars.handle || pars.element_id == _id )
				return null;
				
			if ( String("<%=_str%>").indexOf( pars.element_id ) != -1 )
				return null;
				
			document.forms['event_form'].new_object_id.value = pars.element_id;
			break;
<%
	}
%>
	}

	document.forms['event_form'].submit();
}

function disp_block( _div_id, _img_id )
{
	if ( ! document.getElementById( _div_id ) )
		return false;
		
	_img = document.getElementById( _img_id );
	_div = document.getElementById( _div_id );
	if ( _div.style.display == 'none' )
	{
		_div.style.display = 'inline';
		if( _img )
			_img.src = 'pics/minus.jpg';
	}
	else
	{
		_div.style.display = 'none';
		if( _img )
			_img.src = 'pics/plus.jpg';
	}
	return true;
}

function event_start()
{
	if ( window.confirm( "<%=tools.get_web_str('veb_message1')%>" ) )
		document.location.href='event_start.html?doc_id=<%=curDocID%>&event_id=<%=curObjectID%>&sid=<%=tools.get_sum_sid( curDocID )%>';
}

function event_finish()
{
	if ( window.confirm( "<%=tools.get_web_str('veb_message2')%>" ) )
		document.location.href='event_finish.html?doc_id=<%=curDocID%>&event_id=<%=curObjectID%>&sid=<%=tools.get_sum_sid( curDocID )%>';
}
</SCRIPT>

<FORM ACTION="event_change.html" NAME="event_form" METHOD="POST">
	<input type=hidden name="doc_id" value="<%=curDocID%>"/>
	<input type=hidden name="action" value="save"/>
	<input type=hidden name="object_id" value="<%=curObjectID%>"/>
	<input type=hidden name="sid" value="<%=tools.get_sum_sid( curDocID )%>"/>
	<input type=hidden name="selected_object_id" value=""/>
	<input type=hidden name="new_object_id" value=""/>
	<input type=hidden name="selected_object_ids" value=""/>
		
	<tr>
	<td>
	

<TABLE width="100%" cellspacing="0" cellpadding="4" CLASS="tableBorder">
<TR>
<TD WIDTH="100%">

<%
	if ( _write )
	{
%>

	<TABLE width="100%" cellspacing="0" cellpadding="4">
		<TR>
			<TD><%=tools.get_web_str('c_name')%>:</TD>
			<TD WIDTH="100"><%=tools.get_web_str('c_code')%>:</TD>
		</TR>
		<TR>
			<TD><INPUT TYPE="TEXT" name="name" id="name_id" VALUE="<%=HtmlEncode( curObject.name )%>" CLASS="inputEdit" style="width:100% "></TD>
			<TD WIDTH="100"><INPUT TYPE="TEXT" name="code" id="code_id" VALUE="<%=HtmlEncode( curObject.code )%>" CLASS="inputEdit" style="width:100"></TD>
		</TR>
	</TABLE>
	<TABLE width="100%" cellspacing="4" cellpadding="0">
		<TR>
			<TD width="50%"><%=tools.get_web_str('c_type')%>:</TD>
			<TD><%=tools.get_web_str('c_state')%>:</TD>
		</TR>
		<TR>
			<TD>
				<select NAME="type_id" onchange="doSubmit('save');">
<%
		for ( _type in curLngCommon.event_types )
		{
%>
					<OPTION VALUE="<%=_type.PrimaryKey%>"><%=_type.name%></OPTION>
<%
		}
%>			
				</select>
<SCRIPT language="JavaScript">
selcur=document.forms['event_form'].type_id;
selcur.selectedIndex==-1;
for (i=0;i<selcur.options.length;i++)
    if (selcur.options[i].value=="<%=curObject.type_id%>") {
        selcur.selectedIndex=i;
		break;
    }
</SCRIPT>

			</TD>
			<TD><b><%=curLngCommon.event_status_types.GetChildByKey( curObject.status_id ).name%></b></TD>
		</TR>
		<TR>
			<TD colspan="2">&nbsp;</TD>
		</TR>
<!---------------------------------------------------------------------------------------------------------------------->

<!---------------------------------------------------------------------------------------------------------------------->
		<TR>
			<TD colspan="2"><hr/></TD>
		</TR>
		<TR>
			<TD width="50%"><input type="checkbox" name="is_public" <%=( curObject.is_public ? 'checked' : '' )%>><%=tools.get_web_str('veb_text1')%></TD>
			<TD width="50%"><input type="checkbox" name="disp_persons_for_all" <%=( curObject.disp_persons_for_all ? 'checked' : '' )%>><%=tools.get_web_str('veb_disp_persons_for_all')%></TD>
		</TR>
		<TR>
			<TD width="50%"><input type="checkbox" name="is_open" <%=( curObject.is_open ? 'checked' : '' )%>><%=tools.get_web_str('veb_text2')%></TD>
			<TD width="50%"><input type="checkbox" name="is_open_case" <%=( curObject.is_open_case ? 'checked' : '' )%>><%=tools.get_web_str('veb_text3')%></TD>
		</TR>
		<TR>
			<TD colspan="2"><hr/></TD>
		</TR>
		<TR>
			<TD width="50%">
				<TABLE width="100%" cellspacing="4" cellpadding="0">
					<TR>
						<TD width="140" colspan="2"><%=tools.get_web_str('c_start_date')%>:</TD>
						<TD width="20">&nbsp;</TD>
						<TD width="140" colspan="2"><%=tools.get_web_str('c_finish_date')%>:</TD>
						<TD>&nbsp;</TD>
					</TR>
					<TR>
						<TD width="100"><INPUT TYPE="TEXT" name="start_date" id="start_date_id" VALUE="<%=StrDate( curObject.start_date, false )%>" CLASS="inputEdit" style="width:100"></TD>
						<TD WIDTH="40"><INPUT TYPE="TEXT" name="start_time" id="start_time_id" VALUE="<%=StrTime( curObject.start_date )%>" CLASS="inputEdit" style="width:40"></TD>
						<TD width="20">&nbsp;</TD>
						<TD width="100"><INPUT TYPE="TEXT" name="finish_date" id="finish_date_id" VALUE="<%=StrDate( curObject.finish_date, false )%>" CLASS="inputEdit" style="width:100"></TD>
						<TD WIDTH="40"><INPUT TYPE="TEXT" name="finish_time" id="finish_time_id" VALUE="<%=StrTime( curObject.finish_date )%>" CLASS="inputEdit" style="width:40"></TD>
						<TD>&nbsp;</TD>
					</TR>
				</TABLE>
			</TD>
			<TD>
				<TABLE width="100%" cellspacing="4" cellpadding="0">
					<TR>
						<TD width="140" colspan="2"><%=tools.get_web_str('veb_duration_plan')%>:</TD>
						<TD width="20">&nbsp;</TD>
						<TD width="140" colspan="4"><%=tools.get_web_str('veb_duration_fact')%>:</TD>
						<TD>&nbsp;</TD>
					</TR>
					<TR>
						<TD width="80"><%=curObject.duration_plan%>&nbsp;<%=tools.get_web_str('veb_duration_hours')%></TD>
						<TD width="80"><%=curObject.duration_days_plan%>&nbsp;<%=tools.get_web_str('veb_duration_days')%></TD>
						<TD width="20">&nbsp;</TD>
						<TD width="40"><INPUT TYPE="TEXT" name="duration_fact" id="duration_fact_id" VALUE="<%=curObject.duration_fact%>" CLASS="inputEdit" style="width:40"></TD>
						<TD WIDTH="40"><%=tools.get_web_str('veb_duration_hours')%></TD>
						<TD WIDTH="40"><INPUT TYPE="TEXT" name="duration_days_fact" id="duration_days_fact_id" VALUE="<%=curObject.duration_days_fact%>" CLASS="inputEdit" style="width:40"></TD>
						<TD WIDTH="40"><%=tools.get_web_str('veb_duration_days')%></TD>
						<TD>&nbsp;</TD>
					</TR>
				</TABLE>
			</TD>
		</TR>
		<TR>
			<TD colspan="2"><hr/></TD>
		</TR>
		<TR>
			<TD width="50%">
				<TABLE width="100%" cellspacing="4" cellpadding="0">
					<TR>
						<TD><%=tools.get_web_str('veb_max_person_num')%>:&nbsp;&nbsp;&nbsp;<b><%=curObject.person_num%></b>&nbsp&nbsp;<%=tools.get_web_str('c_of')%>&nbsp;<INPUT TYPE="TEXT" name="max_person_num" id="max_person_num_id" VALUE="<%=curObject.max_person_num%>" CLASS="inputEdit" style="width:60"></TD>
						<TD>&nbsp;</TD>
					</TR>
				</TABLE>
			</TD>
		</TR>
	</TABLE>

<%
	}
	else  //////////////////////////////////////////////////  NOT EDIT  ////////////////////////////////////////////////////////////////////
	{
%>
	<TABLE width="100%" cellspacing="0" cellpadding="4">
		<TR>
			<TD><%=tools.get_web_str('c_name')%>:</TD>
			<TD WIDTH="100"><%=tools.get_web_str('c_code')%>:</TD>
		</TR>
		<TR>
			<TD><b><%=tools_web.get_cur_lng_name( curObject.name )%></b></TD>
			<TD WIDTH="100"><b><%=curObject.code%></b></TD>
		</TR>
	</TABLE>
	<TABLE width="100%" cellspacing="4" cellpadding="0">
		<TR>
			<TD width="50%"><%=tools.get_web_str('c_type')%>:</TD>
			<TD><%=tools.get_web_str('c_state')%>:</TD>
		</TR>
		<TR>
			<TD><b><%=curLngCommon.event_types.GetChildByKey( curObject.type_id ).name%><b></TD>
			<TD><b><%=curLngCommon.event_status_types.GetChildByKey( curObject.status_id ).name%></b></TD>
		</TR>
		<TR>
			<TD colspan="2">&nbsp;</TD>
		</TR>
<!---------------------------------------------------------------------------------------------------------------------->
<%

%>
<!---------------------------------------------------------------------------------------------------------------------->
		<TR>
			<TD colspan="2"><hr/></TD>
		</TR>
		<TR>
			<TD width="50%">
				<TABLE width="100%" cellspacing="4" cellpadding="0">
					<TR>
						<TD width="140"><%=tools.get_web_str('c_start_date')%>:</TD>
						<TD width="20">&nbsp;</TD>
						<TD width="140"><%=tools.get_web_str('c_finish_date')%>:</TD>
						<TD>&nbsp;</TD>
					</TR>
					<TR>
						<TD width="140"><b><%=StrDate( curObject.start_date, true, false )%></b></TD>
						<TD width="20">&nbsp;</TD>
						<TD width="100"><b><%=StrDate( curObject.finish_date, true, false )%></b></TD>
						<TD>&nbsp;</TD>
					</TR>
				</TABLE>
			</TD>
			<TD>
				<TABLE width="100%" cellspacing="4" cellpadding="0">
					<TR>
						<TD width="140"><%=tools.get_web_str('veb_duration_plan')%>:</TD>
						<TD width="20">&nbsp;</TD>
						<TD width="140"><%=tools.get_web_str('veb_duration_fact')%>:</TD>
						<TD>&nbsp;</TD>
					</TR>
					<TR>
						<TD width="140"><b><%=curObject.duration_plan%></b>&nbsp;<%=tools.get_web_str('veb_duration_hours')%>&nbsp;&nbsp;&nbsp;<b><%=curObject.duration_days_plan%></b>&nbsp;<%=tools.get_web_str('veb_duration_days')%></TD>
						<TD width="20">&nbsp;</TD>
						<TD width="140"><b><%=curObject.duration_fact%></b>&nbsp;<%=tools.get_web_str('veb_duration_hours')%>&nbsp;&nbsp;&nbsp;<b><%=curObject.duration_days_fact%></b>&nbsp;<%=tools.get_web_str('veb_duration_days')%></TD>
						<TD>&nbsp;</TD>
					</TR>
				</TABLE>
			</TD>
		</TR>
		<TR>
			<TD colspan="2"><hr/></TD>
		</TR>
		<TR>
			<TD width="50%">
				<TABLE width="100%" cellspacing="4" cellpadding="0">
					<TR>
						<TD><%=tools.get_web_str('veb_max_person_num')%>:&nbsp;&nbsp;&nbsp;<b><%=curObject.person_num%></b>&nbsp&nbsp;<%=tools.get_web_str('c_of')%>&nbsp;<b><%=curObject.max_person_num%></b></TD>
						<TD>&nbsp;</TD>
					</TR>
				</TABLE>
			</TD>
		</TR>

<%
		if ( _view )
		{
%>
		<TR>
			<TD colspan="2">&nbsp;</TD>
		</TR>		
		<TR>
			<TD><%=tools.get_web_str('veb_tutors')%>:</TD>
		</TR>
		<TR>
			<TD colspan="2"><b>
<%
			for ( _tutor in curObject.tutors )
				Response.Write( ( _tutor.ChildIndex == 0 ? '' : ', ' ) + _tutor.person_fullname );
%>
			</b></TD>
		</TR>
<%
		}
%>
	</TABLE>

<%
	}
%>


</TD>
</TR>
</TABLE>

</td>
</tr>



<!-------------------------------------------------- Desc -------------------------------------------------------------------------->
<tr>
<td>
<p class="headerText" style="margin-top:10px; margin-bottom:10px;">&nbsp;<%=tools.get_web_str('vceb_task_case')%></p>
	<%Server.Execute( "view_desc.html" )%>

</td>
</tr>

<!-------------------------------------------------- The best! -------------------------------------------------------------------------->
<%
if ( curObject.public_answers )
{
	event_result_array = XQuery("for $elem in event_results where $elem/event_id=" + curObjectID + " and $elem/is_open=true() order by $elem/person_fullname return $elem");
%>
	<tr>
		<td>
		<br>
		<br>
		<a href="#best" onclick="disp_block('best_div','best_img');" id="best"><p class="headerText" style="margin-top:10px; margin-bottom:10px;"><img src="pics/minus.jpg" id="best_img" border="0"/>&nbsp;<%=tools.get_web_str('vceb_best_decision')%></p></a>			

		<div id="best_div" style="display: inline">			
			<TABLE width="100%" cellspacing="0" cellpadding="4">
				<tr>
					<td class="tableHeaderWithText"><%=tools.get_web_str('c_fio')%></td>
					<td class="tableHeaderWithText"><%=tools.get_web_str('c_answer')%></td>
				</tr>	
				<tr>
					<td class="tableHeaderNoText" colspan="2"><img src="pics/1blank.gif" width="1" height="1" /></td>
				</tr>
<%
	counter = 0;
	
	for ( _event_result in event_result_array )
	{
		_class = counter++ % 2 ? 'tableRowEven' : 'tableRowOdd';
		try
		{
			event_resultDoc = OpenDoc( UrlFromDocID( _event_result.PrimaryKey ) ).TopElem;
		}
		catch(err)
		{
			continue;
		}
%>
				<tr>
					<td width="20%" class="<%=_class%>">
						<%=event_resultDoc.person_fullname%>
					</td>
					<td width="80%" class="<%=_class%>">
						<%=event_resultDoc.collaborator_comment%>
					</td>
				</tr>
<%		
	}
%>
			<tr>
				<td class="tableHeaderNoText" colspan="2"><img src="pics/1blank.gif" width="1" height="1" /></td>
			</tr>
		</table>
		</div>
	</td>
	</tr>
<%
	if ( _write )
	{
%>
	<tr>
		<TD ALIGN="CENTER" class="activator">
				<input type="button" value="<%=tools.get_web_str('c_cancel')%>" onClick="doSubmit('cancel_public')" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';">
		</TD>
	</tr>
<%	
	}
}
%>

<%
	if ( _write || ArrayCount( curObject.custom_elems ) != 0 )
	{
%>
<!------------------------------------------------ Custom elems ----------------------------------------------------------------->
<tr>
<td>

	<br/>
	<br/>
	<a href="#event_additional" onclick="disp_block('event_additional_div','event_additional_img');" id="event_additional"><p class="headerText" style="margin-top:10px; margin-bottom:10px;"><img src="pics/minus.jpg" id="event_additional_img" border="0"/>&nbsp;<%=tools.get_web_str('c_additional')%></p></a>
	<div id="event_additional_div" style="display: inline">
	
<%
		readOnly = true;
		Server.Execute( "view_custom_templates.html" );
%>

	</div>

</td>
</tr>
<%
	}
%>
		



<!------------------------------------------------- COLLABORATORS ----------------------------------------------------------->
<%
	if ( _write || _is_col || _requester || curObject.disp_persons_for_all )
	{
		_view_replace_person = ( _requester && ( ( curObject.date_request_over.HasValue && curObject.date_request_over > Date() ) || ! curObject.date_request_over.HasValue ) );
%>
<tr>
<td>

	<br/>
	<br/>
	<a href="#event_persons" onclick="disp_block('event_persons_div','event_persons_img');" id="event_persons"><p class="headerText" style="margin-top:10px; margin-bottom:10px;"><img src="pics/minus.jpg" id="event_persons_img" border="0"/>&nbsp;<%=tools.get_web_str('veb_persons')%></p></a>
	<div id="event_persons_div" style="display: inline">
	
	<table width="100%"  border="0" cellspacing="0" cellpadding="3">
		<tr>
			<td class="tableHeaderWithText"><%=tools.get_web_str('c_fio')%></td>
			<td class="tableHeaderWithText"><%=tools.get_web_str('c_position')%></td>
			<td class="tableHeaderWithText"><%=tools.get_web_str('c_subd')%></td>
			<td class="tableHeaderWithText" WIDTH="80"><%=tools.get_web_str('veb_exist_now')%></td>
<%
		if ( _write )
		{
%>
			<td class="tableHeaderWithText" WIDTH="80"><%=tools.get_web_str('veb_exist_confirm')%></td>
			<td class="tableHeaderWithText" WIDTH="80"><%=tools.get_web_str('veb_exist')%></td>
<%
		}
%>
			<td class="tableHeaderWithText" WIDTH="20">&nbsp;</td>
<%
		if ( _view_replace_person )
		{
%>
			<td class="tableHeaderWithText" WIDTH="20">&nbsp;</td>
<%
		}
%>
		</tr>
		<tr>
			<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
<%
		if ( _write )
		{
%>	
			<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
<%
		}
%>	
			<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
<%
		if ( _view_replace_person )
		{
%>
			<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
<%
		}
%>				
		</tr>	
			
<%
		counter = 0;
		for ( _person in curObject.collaborators )
		{
			_class = counter++ % 2 ? 'tableRowEven' : 'tableRowOdd';
%>
			
			<TR VALIGN="MIDDLE">
				<TD class="<%=_class%>">
<%
			if ( _write || _person.collaborator_id == curUserID )
			{
%>
					<a HREF="javascript: doSubmit('event_result','<%=_person.PrimaryKey%>');" title="<%=tools.get_web_str('c_tip_result')%>"><%=_person.person_fullname%></a>
<%
			}
			else
			{								
				Response.Write( _person.person_fullname );
			}
%>
				</TD>
				<TD class="<%=_class%>"><%=tools_web.get_cur_lng_name( _person.person_position_name )%></TD>		
				<TD class="<%=_class%>"><%=tools_web.get_cur_lng_name( _person.person_subdivision_name ) + " (" + tools_web.get_cur_lng_name( _person.person_org_name ) + ") "%></TD>		
						
				<TD class="<%=_class%>" ALIGN="CENTER">
<%
				_cur_last_exist_date = curObject.collaborators.GetChildByKey( _person.collaborator_id ).last_exist_date;
				
				if ( _cur_last_exist_date != null && ( DateToRawSeconds( Date() ) - DateToRawSeconds( _cur_last_exist_date ) ) < 1800 )
				{
%>
				<IMG SRC="pics/vwicn082.gif" WIDTH="13" HEIGHT="11" HSPACE="5">
<%
				}
%>
				</TD>
<%
				if ( _write )
				{
					_result_array = XQuery( "for $elem in event_results where $elem/person_id = " + _person.PrimaryKey + " and $elem/event_id = " + curObjectID + " return $elem" );
					
					if ( ArrayCount( _result_array ) != 0 )
					{
						_cur_result = ArrayFirstElem( _result_array );
%>					
				<TD class="<%=_class%>" ALIGN="CENTER">
					<a href="javascript: doSubmit('change_confirm','<%=_cur_result.PrimaryKey%>')" title="<%=tools.get_web_str('veb_tip_exist_confirm')%>">
<%								
						if ( _cur_result.is_confirm )
						{
%>
						<IMG SRC="pics/vwicn082.gif" WIDTH="13" HEIGHT="11" HSPACE="5" border="0">
<%
						}
						else
						{
%>
						<IMG SRC="pics/no.gif" WIDTH="13" HEIGHT="11" HSPACE="5" border="0">
<%
						}
%>
					</a>
				</TD>
				<TD class="<%=_class%>" ALIGN="CENTER">
					<a href="javascript: doSubmit('change_assist','<%=_cur_result.PrimaryKey%>')" title="<%=tools.get_web_str('veb_exist_change')%>">
<%								
						if ( _cur_result.is_assist )
						{
%>
						<IMG SRC="pics/vwicn082.gif" WIDTH="13" HEIGHT="11" HSPACE="5" border="0">
<%
						}
						else
						{
%>
						<IMG SRC="pics/no.gif" WIDTH="13" HEIGHT="11" HSPACE="5" border="0">
<%
						}
%>
					</a>
				</TD>
<%
					}
					else
					{
%>
				<TD class="<%=_class%>" ALIGN="CENTER">&nbsp;</TD>
				<TD class="<%=_class%>" ALIGN="CENTER">&nbsp;</TD>
<%
					}
				}
%>
				<TD class="<%=_class%>" ALIGN="CENTER"><a href="view_doc.html?mode=person&object_id=<%=_person.PrimaryKey%>&doc_id=<%=curDocID%>" title="<%=tools.get_web_str('c_tip_coll')%>"><img src="pics/person.gif" border="0"></a></TD>
<%
		if ( _view_replace_person )
		{
%>
				<TD class="<%=_class%>" ALIGN="CENTER">
<%
			if ( _person.request_person_id == curUserID )
			{
%>
					<a href="#" onclick="doSubmit('replace_collaborator','<%=_person.PrimaryKey%>');return false;" title="<%=tools.get_web_str('veb_replace_coll')%>"><img src="pics/refresh.ico" border="0"/></a>
					&nbsp;
					<a href="#" onclick="if (window.confirm('<%=tools.get_web_str('veb_delete_coll_confirm_part1')%> <%=_person.person_fullname%> <%=tools.get_web_str('veb_delete_coll_confirm_part2')%> ')) doSubmit('delete_collaborator','<%=_person.PrimaryKey%>');return false;" title="<%=tools.get_web_str('veb_delete_coll')%>"><img src="pics/Delete_3.gif" border="0"/></a>
<%
			}
			else
			{
				Response.Write( '\&nbsp;' );
			}
%>
				</TD>
<%
		}
%>
			</TR>
<%
			}
%>
		<tr>
			<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
<%
		if ( _write )
		{
%>	
			<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
<%
		}
%>
			<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>	
<%
		if ( _view_replace_person )
		{
%>
			<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
<%
		}
%>				
		</tr>
	</table>
<%
	if ( _write )
	{
%>	
	<table width="100%" border="0" cellspacing="0" cellpadding="0" class="activator">
		<TD ALIGN="CENTER" class="activator">
			<input type="button" value="<%=tools.get_web_str('veb_b7')%>" onClick="doSubmit('change_collaborators')" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';">
		</TD>
	</table>	
<%
	}
%>

	<%=tools.get_web_str("veb_unnamed_person_num")%>:&nbsp;&nbsp;&nbsp;
<%	
	if ( _write )
	{
%>
		<INPUT TYPE="TEXT" name="unnamed_person_num" id="unnamed_person_num_id" VALUE="<%=curObject.unnamed_person_num%>" CLASS="inputEdit" style="width:60">
<%
	}
	else
	{
%>
	<b><%=curObject.unnamed_person_num%><b>
<%
	}
%>	
<%
_is_lector = false;
for ( _lector in curObject.lectors )
{
	_is_lector = ( _lector.lector_id.ForeignElem.person_id == curUserID );
	if ( _is_lector )
		break;
}

%>
	</div>
	
</td>
</tr>

<%
	}
%>



<!------------------------------------------------- TUTORS ----------------------------------------------------------->
<%
	if ( _write )
	{
%>
<tr>
<td>

	<br/>
	<br/>
	<a href="#event_tutors" onclick="disp_block('event_tutors_div','event_tutors_img');" id="event_tutors"><p class="headerText" style="margin-top:10px; margin-bottom:10px;"><img src="pics/minus.jpg" id="event_tutors_img" border="0"/>&nbsp;<%=tools.get_web_str('veb_tutors')%></p></a>
	<div id="event_tutors_div" style="display: inline">
	
	<table width="100%"  border="0" cellspacing="0" cellpadding="3">
		<tr>
			<td class="tableHeaderWithText"><%=tools.get_web_str('c_fio')%></td>
			<td class="tableHeaderWithText"><%=tools.get_web_str('c_position')%></td>
			<td class="tableHeaderWithText"><%=tools.get_web_str('c_subd')%></td>
			<td class="tableHeaderWithText" WIDTH="20">&nbsp;</td>
		</tr>
		<tr>
			<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>						
		</tr>	
			
<%
		counter = 0;
		for ( _person in curObject.tutors )
		{
			_class = counter++ % 2 ? 'tableRowEven' : 'tableRowOdd';
%>
			<TR VALIGN="MIDDLE">
				<TD class="<%=_class%>"><a HREF="view_doc.html?mode=person&object_id=<%=_person.PrimaryKey%>&doc_id=<%=curDocID%>" title="<%=tools.get_web_str('c_tip_coll')%>"><%=_person.person_fullname%></a></TD>
				<TD class="<%=_class%>"><%=tools_web.get_cur_lng_name( _person.person_position_name )%></TD>		
				<TD class="<%=_class%>"><%=tools_web.get_cur_lng_name( _person.person_subdivision_name )%></TD>		
				<TD class="<%=_class%>" ALIGN="CENTER"><a href="view_doc.html?mode=person&object_id=<%=_person.PrimaryKey%>&doc_id=<%=curDocID%>" title="<%=tools.get_web_str('c_tip_coll')%>"><img src="pics/person.gif" border="0"></a></TD>
			</TR>
<%
		}
%>
		<tr>
			<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>					
		</tr>
	</table>
	
	<table width="100%" border="0" cellspacing="0" cellpadding="0" class="activator">
		<TD ALIGN="CENTER" class="activator">
			<input type="button" value="<%=tools.get_web_str('veb_b7')%>" onClick="doSubmit('change_tutors');" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';"/>
		</TD>
	</table>	

	</div>
	
</td>
</tr>
<%
	}
%>



<!---------------------------------------------- MATERIALS ----------------------------------------------------------------->
<%
	if ( _write )
	{
%>

<tr>
<td>

	<br/>
	<br/>
	<a href="#material_info" onclick="disp_block('material_info_div','material_info_img');" id="material_info"><p class="headerText" style="margin-top:10px; margin-bottom:10px;"><img src="pics/plus.jpg" id="material_info_img" border="0"/>&nbsp;<%=tools.get_web_str('c_materials')%></p></a>
	<div id="material_info_div" style="display: none">

	<TABLE width="100%" cellspacing="0" cellpadding="4" CLASS="tableBorder">
		<TR>
			<TD>&nbsp;</TD>
		</TR>
		<TR>
			<TD WIDTH="250" ALIGN="RIGHT"><%=tools.get_web_str('c_desc')%>:</TD>
			<TD STYLE=" font-weight:normal">
				
						<script type="text/javascript" src="scripts/rte/js/tiny_mce.js"></script>
<script type="text/javascript">
	tinyMCE.init({
		// General options
		mode : "textareas",
		language : "ru",
		theme : "advanced",
		skin : "o2k7",
		skin_variant : "silver",
		plugins : "safari,style,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,fullscreen,noneditable,nonbreaking,xhtmlxtras",

		// Theme options
		theme_advanced_buttons1 : "newdocument,save,|,print,|,search,replace,|,iespell,|,cut,copy,paste,pastetext,pasteword,removeformat,|,undo,redo,|,help,|,fullscreen,|,preview",
		theme_advanced_buttons2 : "styleselect,formatselect,fontselect,fontsizeselect,|,bold,italic,underline,strikethrough,|,sub,sup,|,justifyleft,justifycenter,justifyright,justifyfull,|,bullist,numlist,|,outdent,indent,blockquote,|,forecolor,backcolor",
		theme_advanced_buttons3 : "tablecontrols,|,link,unlink,anchor,|,hr,advhr,|,image,media,charmap,nonbreaking,emotions,|,code,cleanup",
		theme_advanced_toolbar_location : "top",
		theme_advanced_toolbar_align : "left",
		theme_advanced_statusbar_location : "bottom",
		theme_advanced_resizing : true,

		// Example content CSS (should be your site CSS)
		content_css : "scripts/rte/css/content.css",

		// Drop lists for link/image/media/template dialogs
		template_external_list_url : "scripts/rte/lists/template_list.js",
		external_link_list_url : "scripts/rte/lists/link_list.js",
		external_image_list_url : "scripts/rte/lists/image_list.js",
		media_external_list_url : "scripts/rte/lists/media_list.js",

		// Replace values for the template plugin
		template_replace_values : {
			username : "Some User",
			staffid : "991234"
		}
	});
</script>

		<textarea id="elm1" name="desc" rows="20" cols="80" style="width: 100%; height: 400px;"><%=HtmlEncode( curObject.desc )%></textarea>
			</TD>
		</TR>
	</TABLE>
	
	</div>
	
</td>
</tr>
<%
	}
%>



<!---------------------------------------------- FILES ----------------------------------------------------------------->
<tr>
<td>
	
	<br/>	
	<%Server.Execute( "view_files.html" )%>
		
</td>
</tr>

<!---------------------------------------------- PREPARATIONS ----------------------------------------------------------------->
<%
	if ( _write || _is_beginer )
	{
%>
<tr>
<td>
	
	<br/>
	<br/>
	<a href="#even_preparations" onclick="disp_block('even_preparations_div','even_preparations_img');" id="even_preparations"><p class="headerText" style="margin-top:10px; margin-bottom:10px;"><img src="pics/minus.jpg" id="even_preparations_img" border="0"/>&nbsp;<%=tools.get_web_str('veb_preparation')%></p></a>
	<div id="even_preparations_div" style="display: inline">
	
	<table width="100%"  border="0" cellspacing="0" cellpadding="3">
		<tr>
			<td class="tableHeaderWithText"><%=tools.get_web_str('c_fio')%></td>
			<td class="tableHeaderWithText" WIDTH="100"><%=tools.get_web_str('c_plan_date')%></td>
			<td class="tableHeaderWithText" WIDTH="100"><%=tools.get_web_str('c_fact_date')%></td>
			<td class="tableHeaderWithText" WIDTH="100"><%=tools.get_web_str('c_status')%></td>
			<td class="tableHeaderWithText"><%=tools.get_web_str('c_desc')%></td>
			<td class="tableHeaderWithText"><%=tools.get_web_str('veb_preparation_comment')%></td>
			<td class="tableHeaderWithText" WIDTH="20">&nbsp;</td>
		</tr>
		<tr>
			<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
		</tr>	
			
<%
		counter = 0;
		for ( _even_preparation in curObject.even_preparations )
		{
			_class = counter++ % 2 ? 'tableRowEven' : 'tableRowOdd';
%>
			
		<TR VALIGN="MIDDLE">
			<TD class="<%=_class%>">
<%
			if ( _write || curUserID == _even_preparation.person_id )
			{
%>
				<a href="javascript: doSubmit('event_preparation','<%=_even_preparation.PrimaryKey%>');" title="<%=tools.get_web_str('veb_tip_preparation')%>"><%=_even_preparation.person_fullname%></a>
<%
			}
			else
			{
				Response.Write( _even_preparation.person_fullname );
			}
%>
			</TD>
			<TD class="<%=_class%>" ALIGN="CENTER"><%=StrDate( _even_preparation.plan_date, true, false )%></TD>
			<TD class="<%=_class%>" ALIGN="CENTER"><%=StrDate( _even_preparation.fact_date, true, false )%></TD>					
			<TD class="<%=_class%>" ALIGN="CENTER">
<%
			try
			{ 
				Response.Write(  curLngCommon.event_status_types.GetChildByKey( _even_preparation.status_id ).name );
			}
			catch ( pp )
			{
			}
			
			
			_person = _even_preparation.person_id.OptForeignElem;
%>
			</TD>
			<TD class="<%=_class%>" ALIGN="CENTER"><%=_even_preparation.comment%></TD>
			<TD class="<%=_class%>" ALIGN="CENTER"><%=_even_preparation.comment_person%></TD>
			<TD class="<%=_class%>" ALIGN="CENTER">
<%
	if (_person != undefined)
	{
%>
				<a href="view_doc.html?mode=person&object_id=<%=_person.PrimaryKey%>&doc_id=<%=curDocID%>" title="<%=tools.get_web_str('c_tip_coll')%>"><img src="pics/person.gif" border="0"></a>
<%
	}
%>
				&nbsp;
			</TD>
		</TR>
<%
		}
%>
		<tr>
			<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
			<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
		</tr>
	</table>
<%	
		if ( _write )	
		{
%>
	<table width="100%" border="0" cellspacing="0" cellpadding="0" class="activator">
		<TD ALIGN="CENTER" class="activator">
			<input type="button" value="<%=tools.get_web_str('veb_add')%>" onClick="doSubmit('add_preparation');" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';"/>
		</TD>
	</table>
<%
		}
%>

	</div>
</td>
</tr>
<%
	}
%>



<!----------------------------------------------- ACTIONS -------------------------------------------------------------------------->
<tr>
<td>

<br/>
<br/>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="activator">
	<tr>
		<TD ALIGN="CENTER" class="activator">
<%
		if ( _write )
		{

%>
			<input type="button" value="<%=tools.get_web_str('veb_b1')%>" onClick="event_start(); return false;" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';" STYLE="width:150px ">
			<input type="button" value="<%=tools.get_web_str('veb_b2')%>" onClick="event_finish(); return false;" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';" STYLE="width:170px ">
			&nbsp;&nbsp;&nbsp;&nbsp;
			<input type="button" value="<%=tools.get_web_str('veb_activate_test')%>" onClick="doSubmit('activate_test');" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';">
			&nbsp;&nbsp;&nbsp;&nbsp;
			<input type="button" value="<%=tools.get_web_str('c_save')%>" onClick="doSubmit('save');" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';">
<%
			if ( curObject.status_id == 'project' )
			{
%>
			&nbsp;&nbsp;&nbsp;&nbsp;
			<input type="button" value="<%=tools.get_web_str('c_delete')%>" onClick="doSubmit('delete');" class="inputButton" STYLE="width:80px " onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';">
<%
			}
		}
%>
		</TD>
	</tr>
<%
		if ( _view && curObject.default_response_type_id.HasValue )
		{
%>		
	<tr>
		<TD ALIGN="CENTER" class="activator">
			<input type="button" value="<%=tools.get_web_str('c_text_create_response')%>" onClick="document.location.href='view_doc.html?mode=response&doc_id=<%=curDocID%>&response_object_id=<%=curObjectID%>&response_type_id=<%=curObject.default_response_type_id%>';return false;" CLASS="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';">	
		</TD>
	</tr>
<%			
		}
		
		if ( curObject.is_open && ! _is_col && curObject.status_id != 'project' && curObject.status_id != 'close' && curObject.status_id != 'cancel' )
		{
%>			
	<tr>
		<TD ALIGN="CENTER" class="activator">
<%
			if ( curUser.in_request_black_list )
			{
%>
				<b><%=tools.get_web_str('veb_text_in_request_black_list')%></b>
<%
			}
			else if ( curObject.date_request_over.HasValue && curObject.date_request_over < Date() )
			{
%>
				<b><%=tools.get_web_str('veb_request_time_expired')%></b>
<%
			}
			else if ( curObject.date_request_begin.HasValue && curObject.date_request_begin > Date() )
			{
%>
				<b><%=tools.get_web_str('veb_request_time_begin')%></b>
<%
			}
			else if ( curObject.default_request_type_id.HasValue )
			{
%>
			<input type="button" value="<%=tools.get_web_str('c_text_create_request')%>" onClick="document.location.href='view_doc.html?mode=request_create&doc_id=<%=curDocID%>&request_object_id=<%=curObjectID%>&request_type_id=<%=curObject.default_request_type_id%>';return false;" CLASS="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';">
<%
			}
			else
			{
%>
			<%=tools.get_web_str('c_text_create_request')%>:&nbsp;			
<%
				_request_type_array = XQuery( "for $elem in request_types where $elem/object_type = 'event' return $elem" )
				for ( _request_type in _request_type_array )
				{
%>	
			<input type="button" value="<%=tools_web.get_cur_lng_name( _request_type.name )%>" onClick="document.location.href='view_doc.html?mode=request_create&type=event&doc_id=<%=curDocID%>&request_object_id=<%=curObjectID%>&request_type_id=<%=_request_type.PrimaryKey%>';return false;" CLASS="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';">
<%
				}
			}
%>
		</TD>
	</tr>
<%
		}
		
		if ( curObject.is_open_case && ! _is_col && curObject.status_id != 'project' && curObject.status_id != 'close' && curObject.status_id != 'cancel' )
		{
%>			
	<tr>
		<TD ALIGN="CENTER" class="activator">

			<input type="button" value="<%=tools.get_web_str('veb_activate_case')%>" onClick="doSubmit('add_collaborator','<%=curUserID%>');" CLASS="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';">

			
		</TD>
	</tr>
<%
		}
		
		if ( _write && !curObject.public_answers )
		{
%>		
	<tr>
		<TD ALIGN="CENTER" class="activator">

			<input type="button" value="<%=tools.get_web_str('vceb_publish')%>" onClick="doSubmit('public');" CLASS="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';">

			
		</TD>
	</tr>
<%
		}
%>	
</table>	

</td>
</tr>



</FORM>

</table>


		</td>
	</tr>
</table>