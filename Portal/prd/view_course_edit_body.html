<%
	try
	{
		curCourseID = Int( Request.QueryString.object_id );
		curCourse = OpenDoc( UrlFromDocID( curCourseID ) ).TopElem;
		
		if ( tools.check_access(curCourse, curUserID) == false ) throw "ne lez!";
	}
	catch(_fuck_)
	{
		curCourse = null;
		curCourseID = null;
	}

	try
	{
		Session.RETURN_MSG;
	}
	catch(_x_)
	{
		Session.RETURN_MSG = "";
	}

	if (Session.RETURN_MSG != "")
	{
		Response.Write("<br/><center><font size='+1' align='center'><i><b>" + HtmlEncode(Session.RETURN_MSG) + "</b></i></font></center>");
		Session.RETURN_MSG = "";
	}
%>

<script language="javascript">
<!--
//------------------------------------------------------------------------------------------

function checkkey(srcobj, e, flag_flat)
{
	if (!e) var e = window.event;
	var keycode = parseInt(e.keyCode ? e.keyCode : e.which);
	if ((keycode<48 || keycode>57) && keycode!=46) return false;
	if (keycode==46) 
	{
		if( (!flag_flat) || srcobj.value.indexOf('.') >= 0) return false;
	}
	return true;
}
//------------------------------------------------------------------------------------------

function what2submit()
{
	if (document.getElementById("name").value == ""){window.alert(<%=CodeLiteral( tools_web.get_web_str('vceb_mess_empty_name') )%>); return false;}
	
	var _width = parseInt(document.getElementById("win_width").value);
	var _height = parseInt(document.getElementById("win_height").value);
	
	if (isNaN(_width)){window.alert(<%=CodeLiteral( tools_web.get_web_str('vceb_mess_empty_width') )%>); return false;}
	if (isNaN(_height)){window.alert(<%=CodeLiteral( tools_web.get_web_str('vceb_mess_empty_height') )%>); return false;}
	
	return true;
}
-->
</script>
<!--
<input type="button" onclick="debuggg()" value="DeBuG!" style="font-family:Wingdings" class="inputButton"/>
-->

<table width="100%"  border="0" cellspacing="0" cellpadding="3" name="top_report_table">
<tr>
<td>

<%
	if (curCourseID != null)
	{
%>
<script language="JavaScript">
<!--
<%
	var _part_pic_lesson="pics/lesson.gif";
	var _part_pic_inline="pics/text.gif";
	var _part_pic_test="pics/test.gif";
%>
var _part_pic_lesson="<%=_part_pic_lesson%>";
var _part_pic_inline="<%=_part_pic_inline%>";
var _part_pic_test="<%=_part_pic_inline%>";

function toggle_section(_word)
{	
	$("form#course_submitter div[id^='cdiv_']").each(function(){ if (this.id == "cdiv_" + _word) $(this).show(); else $(this).hide(); });
	$("form#course_submitter td[id^='ctd_']").each(function(){if (this.id == "ctd_" + _word)	{$(this).addClass("tab_td_sel"); $(this).removeClass("tab_td");} else {$(this).removeClass("tab_td_sel"); $(this).addClass("tab_td");} });
	return false;
}
-->
</script>
<form name="course_submitter" id="course_submitter" action="content_panel_process.html" method="post">
<input type="hidden" name="course_id" value="<%=curCourseID%>"/>
<input type="hidden" name="doc_id" value="<%=curDocID%>"/>
<input type="hidden" name="mode" value="course"/>
<input type="hidden" name="href" value="<%=Request.Url%>"/>
<%
	Server.Execute( "view_tinymce.html" );
%>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
	<tr>
		<td class="tab_td_empty"><img src="pics/1blank.gif" width="10" height="0"/></td>
		<td class="tab_td" id="ctd_0" onclick="return toggle_section('0');"><img src="pics/1blank.gif" width="140" height="0"/><br/><a style="text-decoration:none" href="#" onclick="return toggle_section('0');"><%=tools_web.get_web_str('c_common_settings')%></a></td>
		<td class="tab_td_empty" width="10px">&nbsp;</td>
		<td class="tab_td" id="ctd_1" onclick="return toggle_section('1');"><img src="pics/1blank.gif" width="140" height="0"/><br/><a style="text-decoration:none" href="#" onclick=" return toggle_section('1');"><%=tools_web.get_web_str('c_sections')%></a></td>
		<td class="tab_td_empty" width="10px">&nbsp;</td>
		<td class="tab_td" id="ctd_2" onclick="return toggle_section('2');"><img src="pics/1blank.gif" width="140" height="0"/><br/><a style="text-decoration:none" href="#" onclick=" return toggle_section('2');"><%=tools.get_web_str('c_desc')%></a></td>
		<td class="tab_td_empty" width="10px">&nbsp;</td>
		<td class="tab_td_empty" width="100%">&nbsp;</td>
	</tr>
</table>
<br/>

<div width="100%" id="cdiv_0" style="display: none">
<table width="100%" cellspacing="0" cellpadding="4" class="tableBorder" border="0">
	<tr>
		<td style="font-weight:bolder; font-size:larger;" width="90px"><%=tools.get_web_str('c_name')%>:</td>
		<td style="font-weight:bolder; font-size:larger"><input type="text" id="name" name="name" value="<%=curCourse.name%>" class="inputEdit" style="width:100%"/></td>
	</tr>
	<tr>
		<td style="font-weight:bolder; font-size:larger;" width="90px"><%=tools.get_web_str('c_status')%>:</td>
		<td style="font-weight:bolder; font-size:larger">
		<select id="status" name="status">
<%
		for (_t in common.course_test_states) Response.Write("<option value='"+_t.PrimaryKey+"' " +(curCourse.status == _t.PrimaryKey ? "selected":"")+ ">"+_t.name+"</option>");
%>
		</select>
		</td>
	</tr>
</table>
<br/>
<table width="100%">
	<tr>
		<td style="font-weight:bolder; width: 110px"><%=tools.get_web_str('c_pass_score')%>:</td><td ><input type="text" id="mastery_score" name="mastery_score" value="<%=curCourse.mastery_score%>" class="inputEdit" style="width:100px" onkeypress="return checkkey(this,event, false);" onblur="return checkkey(this,event, false);"/></td>
		<td style="font-weight:bolder; width: 130px"><%=tools_web.get_web_str('c_max_score')%>:</td><td><input type="text" id="max_score" name="max_score" value="<%=curCourse.max_score%>" class="inputEdit" style="width:100px" onkeypress="return checkkey(this,event, false);" onblur="return checkkey(this,event, false);"/></td>
	<td style="font-weight:bolder; width: 180px"><%=tools_web.get_web_str('c_day_duration')%>:</td><td ><input type="text" id="duration" name="duration" value="<%=curCourse.duration%>" class="inputEdit" style="width:100px" onkeypress="return checkkey(this,event, false);" onblur="return checkkey(this,event, false);"/></td>
	</tr>
</table>
<br/>
<table>
		<tr>
		<td>
			<input type="checkbox" name="yourself_start" id="yourself_start" <%=(curCourse.yourself_start ? "checked": "")%> value="1"/><%=tools_web.get_web_str('vceb_can_self')%><br/>
			<input type="checkbox" name="finish_without_mastery_score" id="finish_without_mastery_score" <%=(curCourse.finish_without_mastery_score ? "checked": "")%> value="1"/><%=tools_web.get_web_str('vceb_can_finish')%><br/>
		</td>
		</tr>
</table>
<br/>
<table width="100%">
	<tr>
		<td style="font-weight:bolder; width: 110px"><%=tools_web.get_web_str('vceb_view_type')%>:</td>
		<td>
			<input type="radio" name="view_type" id="view_type" <%=(curCourse.view_type == "single" ? "checked": "")%> value="single"/><%=tools_web.get_web_str('vceb_popup')%><br/>
			<input type="radio" name="view_type" id="view_type" <%=(curCourse.view_type == "structure" ? "checked": "")%> value="structure"/><%=tools_web.get_web_str('vceb_with_struct')%>
		</td>
	</tr>
</table>
<br/>
<table style="font-weight:bolder; width: 110px">
	<tr>
		<td colspan="4"><%=tools_web.get_web_str('vceb_win_size')%></td>
	</tr>
	<tr>
		<td><%=tools_web.get_web_str('veb_mat_w')%>:</td><td><input type="text" id="win_width" name="win_width" value="<%=curCourse.win_width%>" class="inputEdit" style="width:100px" onkeypress="return checkkey(this,event, false);" onblur="return checkkey(this,event, false);"/>&nbsp;&nbsp;&nbsp;</td>
		<td style="font-weight:bolder; width: 130px"><%=tools_web.get_web_str('veb_mat_h')%>:</td><td><input type="text" id="win_height" name="win_height" value="<%=curCourse.win_height%>" class="inputEdit" style="width:100px" onkeypress="return checkkey(this,event, false);" onblur="return checkkey(this,event, false);"/></td>
	</tr>
</table>

		<table width="100%"  border="0" cellspacing="0" cellpadding="3">
			<tr id="line_head">
				<td class="tableHeaderWithText"><%=tools_web.get_web_str('vceb_experts')%></td>
				<td class="tableHeaderWithText" width="200px"><%=tools.get_web_str('c_type')%></td>
			</tr>
			<tr>
				<td class="tableHeaderNoText" colspan="2"><img src="pics/1blank.gif" width="1" height="1"/></td>
			</tr>	
			<tbody id="expertizer"></tbody>
			<tr>
				<td class="tableFooter" colspan="2"><img src="pics/1blank.gif" width="1" height="1"/></td>
			</tr>
		</table>
		<table width="100%" border="0" cellspacing="0" cellpadding="0" class="activator">
		<TR>
			<TD ALIGN="CENTER" class="activator">
				<input type="hidden" name="experts_count" id="experts_count" value="0"/>
				<input type="button" value="<%=tools_web.get_web_str('vceb_sel_experts')%>" onClick="select_experts();" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';"/>
			</TD>
		</TR>
		</table>
		<script language="javascript">
		<!--
			var temp_selected_object_ids = "<%=ArrayMerge(curCourse.persons, "This.person_id", ";")%>";
			function select_experts()
			{
				var pars=new Object(); pars.check_access = true;
				var strAttr='status:no;dialogWidth:780px;dialogHeight:550px;help:no;resizable:1';
				
				if (pars.display_object_ids == '') pars.display_object_ids = '0';
				
				pars.selected_object_ids = temp_selected_object_ids;
				pars.can_be_empty = true;
				xShowModalDialog('dlg_select.html?doc_id=<%=curDocID%>&catalog_name=collaborator&typein=1&multi_select=1&rand='+Math.random(), pars, strAttr);
				if (!pars.handle ) return false;
				
				$('tbody#expertizer').empty();
				var item_count = 0;
				temp_selected_object_ids = "";
				for (var _x = item_count; _x < pars.elemArray.length; _x++)
				{
					add_expert(pars.elemArray[_x], pars.elemNamesArray[_x], null);
					temp_selected_object_ids += pars.elemArray[_x]+";"
				}
			}
			
			function add_expert(_id, _name, sType)
			{
				var item_count = parseInt($("#experts_count").val());
				var _class = item_count % 2 ? 'tableRowEven' : 'tableRowOdd';
				var sTypeSelect = '<select id="expert_type_'+item_count+'" name="expert_type_'+item_count+'">';
<%
				for(fldTypeElem in common.course_expert_types)
				{
%>
					sTypeSelect += '<option id="<%=fldTypeElem.id%>">'+"<%=HtmlEncode(fldTypeElem.name)%>"+'</option>';
<%
				}
%>
				sTypeSelect += '</select>';
				$('tbody#expertizer').append('<tr><td class="' +_class+ '"><input type="hidden" id="expert_id_'+item_count+'" name="expert_id_'+item_count+'" value="'+_id+'"/>' +_name+ '</td><td class="' +_class+ '">'+sTypeSelect+'</td></tr>');
				$("#experts_count").val(item_count+1);
				
				if (sType != null)
					$('tbody#expertizer select#expert_type_'+item_count).val(sType);
			}
<%
			for (catExpertElem in curCourse.persons)
			{
				Response.Write("add_expert(\"" + catExpertElem.person_id + "\", \"" + HtmlEncode(catExpertElem.person_fullname) +"\", \"" + catExpertElem.type + "\");");
			}
%>
		-->
		</script>
		


</div>

<div width="100%" id="cdiv_1" style="display: none">
<script language="javascript">
<!--
function toggle_part(_part_code)
{
	var _i = 0;
	var o = document.getElementById("part_index_" + _i);
	var dv,ap;
	
	while (o!= undefined)
	{
		dv = document.getElementById("div_part_"+o.value);
		if (dv != undefined) dv.style.display = "none";
		ap = document.getElementById("a_part_"+o.value);
		if (ap != undefined) ap.style.fontWeight = "normal";
		_i++;
		o = document.getElementById("part_index_" + _i);
	}
	
	dv = document.getElementById("div_part_"+_part_code);
	if (dv != undefined) dv.style.display = "inline";
	ap = document.getElementById("a_part_"+_part_code);
		if (ap != undefined) ap.style.fontWeight = "bold";
	
	return false;
}
//-----------------------------------------
function reveal_part_controls(_part_code, _type)
{
	var _flappin_divs = document.getElementById("course_submitter").getElementsByTagName("div");
	for (var i=0; i<_flappin_divs.length;i++)
	{
		if (_flappin_divs[i].getAttribute("name") == ("parttypediv_" + _part_code) && _flappin_divs[i].getAttribute("parttype") != undefined)
			if (_flappin_divs[i].getAttribute("parttype").indexOf(_type) >=0)
				_flappin_divs[i].style.display = "inline";
			else
				_flappin_divs[i].style.display = "none";
	}
	return false;
}
function add_part()
{
	if (!confirm(<%=CodeLiteral( tools_web.get_web_str('vceb_mess_add_sec') )%>))
		return false;
	
	var pars = new Object;
	var strAttr="status:no;dialogWidth:700px;dialogHeight:200px;help:no;resizable:no";	
	xShowModalDialog("dlg_textarea.html?doc_id=<%=curDocID%>&rand="+Math.random() + "&show_input=1&input_title="+escape('<%=tools_web.get_web_str('vmi_add_name_section')%>'), pars, strAttr);

	if (!pars.handle) return false;
	var stringa = pars.input_value;
	if (stringa == null) return false;
	if (stringa == '') return false;
	if (stringa.length > 500) stringa = stringa.substring(0, 500);
	stringa = String(stringa).replace(/;/, "");
	if (!window.confirm(<%=CodeLiteral( tools_web.get_web_str('vceb_mess_create_subsec') )%>)) return false;
	
	if (what2submit())
	{
		document.forms["course_submitter"].elements["new_part_name"].value = stringa;
		document.forms["course_submitter"].submit();
	}
}
function remove_part(_sId,_sName)
{
	if (!confirm(<%=CodeLiteral( tools_web.get_web_str('vceb_mess_del_section') )%>))
		return false;
	if (what2submit())
	{
		$("form#course_submitter input#dead_part_name").val(_sId);
		$("form#course_submitter").submit();
	}
}
-->
</script>
	<input type="hidden" id="new_part_name" name="new_part_name" value=""/>
	<input type="hidden" id="dead_part_name" name="dead_part_name" value=""/>
	<table width="100%">
		<tr>
			<td width="200px" valign="top">
	<%
		for (_part in curCourse.parts)
		{
	%>
			<a id="a_part_<%=_part.code%>" href="#" onclick="return toggle_part('<%=_part.code%>')"><img border="0" src="<%=OptEval("_part_pic_" + _part.type, "pics/arrow.gif")%>">&nbsp;<%=_part.name%></a><br/>
	<%
		}
	%>
			<br/>
			<input type="button" onclick="add_part();" value="<%=tools_web.get_web_str('vceb_add_section')%>" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';"/>
			</td>
			<td valign="top">
	<%
		for (_part in curCourse.parts)
		{
	%>
			<div width="100%" id="div_part_<%=_part.code%>" style="display: none">
				<input type="hidden" id="part_index_<%=_part.ChildIndex%>" name="part_index_<%=_part.ChildIndex%>" value="<%=_part.code%>"/>
				
				<table width="100%" cellspacing="0" cellpadding="4" class="tableBorder" border="0">
					<tr>
						<td style="font-weight:bolder; font-size:larger;" width="90px"><%=tools.get_web_str('c_name')%>:</td>
						<td style="font-weight:bolder; font-size:larger"><input type="text" id="part_<%=_part.code%>_name" name="part_<%=_part.code%>_name" value="<%=_part.name%>" class="inputEdit" style="width:100%"/></td>
					</tr>
					<tr>
						<td style="font-weight:bolder; font-size:larger;" width="90px"><%=tools_web.get_web_str('c_max_score')%>:</td>
						<td style="font-weight:bolder; font-size:larger">
							<input type="text" id="part_<%=_part.code%>_max_score" name="part_<%=_part.code%>_max_score" value="<%=_part.max_score%>" class="inputEdit" style="width: 50px" onkeypress="return checkkey(this,event, false);" onblur="return checkkey(this,event, false);"/>
						</td>
					</tr>
					<tr>
						<td style="font-weight:bolder; font-size:larger;"></td>
						<td><input type="radio" name="part_<%=_part.code%>_type" value="lesson" <%=(_part.type =="lesson"?"checked":"")%> onclick="reveal_part_controls('<%=_part.code%>','lesson')"/><%=tools_web.get_web_str('c_module')%>&nbsp;<input type="radio" name="part_<%=_part.code%>_type" value="test" <%=(_part.type =="test"?"checked":"")%> onclick="reveal_part_controls('<%=_part.code%>','test')"/><%=tools_web.get_web_str('c_test')%>&nbsp;<input type="radio" name="part_<%=_part.code%>_type" value="inline" <%=(_part.type =="inline"?"checked":"")%> onclick="reveal_part_controls('<%=_part.code%>','inline')"/><%=tools_web.get_web_str('vfb_text')%></td>
					</tr>
				</table>
				<div name="parttypediv_<%=_part.code%>" parttype="test" style="display:none">
					<table width="100%" cellspacing="0" cellpadding="4" class="tableBorder_" border="0">
						<tr>
							<td style="font-weight:bolder;" width="90px"><%=tools_web.get_web_str('c_section')%>:</td>
							<%
								_cur_ass = _part.assessment_id.OptForeignElem;
							%>
							<td style="font-weight:bolder;"><input type="text" id="part_<%=_part.code%>_assessment_name" name="part_<%=_part.code%>_assessment_name" value="<%=(_cur_ass != undefined ? HtmlEncode(_cur_ass.title) : "")%>" class="inputEdit" style="width:100%" readonly/>
							<input type="hidden" name="part_<%=_part.code%>_assessment_id" id="part_<%=_part.code%>_assessment_id" value="<%=(_cur_ass != undefined ? _cur_ass.id : "")%>"/>
							</td>
							<td style="font-weight:bolder;" width="25px">
							<input type="button" value="..." class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';" onclick="
								var pars=new Object(); pars.check_access = true;
								var strAttr='status:no;dialogWidth:780px;dialogHeight:550px;help:no;resizable:1';
								xShowModalDialog('dlg_select.html?doc_id=<%=curDocID%>&catalog_name=assessment&typein=0&multi_select=0&rand='+Math.random(), pars, strAttr);
								if (!pars.handle ) return false;
								
								$('#part_<%=_part.code%>_assessment_id').val(pars.element_id);
								$('#part_<%=_part.code%>_assessment_name').val(pars.element_name);
								$('#part_<%=_part.code%>_url').val('');
							" style="width: 25px"/>
							</td>
						</tr>
					</table>
				</div>
				<div name="parttypediv_<%=_part.code%>" parttype="lesson" style="display:none">
					<table width="100%" cellspacing="0" cellpadding="4" class="tableBorder_" border="0">
					<tr>
						<td style="font-weight:bolder;" width="90px"><%=tools_web.get_web_str('veb_mat_w')%>:</td>
						<td style="font-weight:bolder;"><input type="text" id="part_<%=_part.code%>_win_width" name="part_<%=_part.code%>_win_width" value="<%=_part.win_width%>" class="inputEdit" style="width:100%" onkeypress="return checkkey(this,event, false);" onblur="return checkkey(this,event, false);"/></td>
					</tr>
					<tr>
						<td style="font-weight:bolder;" width="90px"><%=tools_web.get_web_str('veb_mat_h')%>:</td>
						<td style="font-weight:bolder;"><input type="text" id="part_<%=_part.code%>_win_height" name="part_<%=_part.code%>_win_height" value="<%=_part.win_height%>" class="inputEdit" style="width:100%" onkeypress="return checkkey(this,event, false);" onblur="return checkkey(this,event, false);"/></td>
					</tr>
					</table>
				</div>
				<div name="parttypediv_<%=_part.code%>" parttype="lesson;test" style="display:none">
					<table width="100%" cellspacing="0" cellpadding="4" class="tableBorder_" border="0">
					<tr>
						<td style="font-weight:bolder;" width="90px">URL:</td>
						<td style="font-weight:bolder;"><input type="text" id="part_<%=_part.code%>_url" name="part_<%=_part.code%>_url" value="<%=_part.url%>" class="inputEdit" style="width:100%"/></td>
					</tr>
					<tr>
						<td style="font-weight:bolder;" width="90px"><%=tools_web.get_web_str('c_pass_score')%>:</td>
						<td style="font-weight:bolder;"><input type="text" id="part_<%=_part.code%>_mastery_score" name="part_<%=_part.code%>_mastery_score" value="<%=_part.mastery_score%>" class="inputEdit" style="width:100%" onkeypress="return checkkey(this,event, false);" onblur="return checkkey(this,event, false);"/></td>
					</tr>
					<tr>
						<td style="font-weight:bolder;" width="90px"><%=tools_web.get_web_str('vceb_factor')%>:</td>
						<td style="font-weight:bolder;"><input type="text" id="part_<%=_part.code%>_score_factor" name="part_<%=_part.code%>_score_factor" value="<%=_part.score_factor%>" class="inputEdit" style="width:100%" onkeypress="return checkkey(this,event, false);" onblur="return checkkey(this,event, false);"/></td>
					</tr>
					<tr>
						<td style="font-weight:bolder;" width="90px"><%=tools.get_web_str('c_attempt_num')%>:</td>
						<td style="font-weight:bolder;"><input type="text" id="part_<%=_part.code%>_attempts_num" name="part_<%=_part.code%>_attempts_num" value="<%=_part.attempts_num%>" class="inputEdit" style="width:100%" onkeypress="return checkkey(this,event, false);" onblur="return checkkey(this,event, false);"/></td>
					</tr>
					</table>
				</div>
				
				<table width="100%" cellspacing="0" cellpadding="4" class="tableBorder_" border="0">
					<tr>
						<td style="font-weight:bolder;"><input type="checkbox" name="part_<%=_part.code%>_is_mandatory" id="part_<%=_part.code%>_is_mandatory" <%=(_part.is_mandatory ? "checked": "")%> value="1"/><%=tools_web.get_web_str('vceb_must_add')%></td>
					</tr>
					<tr>
						<td style="font-weight:bolder;">
						<%=tools.get_web_str('c_desc')%>:<br/>
						<textarea trigger id="part_<%=_part.code%>_desc" name="part_<%=_part.code%>_desc" style="width:100%"><%=(_part.desc != null ? _part.desc : "")%></textarea>
						</td>
					</tr>
				</table>
				<br/>
				<input type="button" onclick='remove_part("<%=_part.code%>", "<%=HtmlEncode(_part.name)%>");' value="<%=tools_web.get_web_str('vceb_del_section')%>" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';"/>
			</div>
			<script language="javascript">reveal_part_controls("<%=_part.code%>", "<%=_part.type%>");</script>
	<%
		}
	%>
			</td>
		</tr>
	</table>
</div>
<div width="100%" id="cdiv_2" style="display: none">
	<textarea trigger id="desc" name="desc" style="width:100%; height: 500px"><%=(curCourse != null ? curCourse.desc : "")%></textarea>
</div>
<br/>
		<center><input type="submit" value="<%=tools.get_web_str('c_save')%>" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';" onclick="return what2submit();"/></center>
</form>
<script language="javascript">
<!--
toggle_section("0");
-->
</script>
<%
}
else
	Response.Write("<h1>"+ tools_web.get_web_str('vceb_err_open') + "</h1><br/>");
	
	_href = tools_web.get_url_protocol( Request.Url ) + Request.UrlHost + UrlPath( Request.Url ) + "?mode=content_panel&tab=course&doc_id="+curDocID;
%>
<center><input type="button" value="<%=tools_web.get_web_str('vaaeb_list_back')%>" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';" onclick="window.location.href='<%=_href%>'"/></center>
<br/>
<%
	Server.Execute("view_knowledge_parts_base.html");
%>
</td>
</tr>
<tr>
	<td colspan="3" class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
</tr>
</table>
