<table class="leftPanelTable" width="100%" border="0" cellspacing="0" cellpadding="0"> 
	<tr>
		<td class="tableLeftHeader" colspan="3"><div class="headerText" style="margin-top:10px;margin-bottom:5px;margin-left:5px;"><%=tools.get_web_str('vsb_docs')%></div></td> 
	</tr> 
<%
try
{
	curRefMode;
}
catch(_x_)
{
	curRefMode = "documents";
}

parentDocumentArray = ArraySelect( parentAllDocumentArray, '! parent_object_id.HasValue' );
for ( _doc in parentDocumentArray )
{
%>
	<tr> 
		<td class="newsColumnDigestLeft"><img src="pics/1blank.gif" width="0" height="0" /></td>
		<td class="horDivider"><img src="pics/1blank.gif" width="0" height="0" /></td> 
		<td class="newsColumnDigestRight"><img src="pics/1blank.gif" width="0" height="0" /></td>
	</tr> 
	<tr>
		<td class="newsColumnDigestLeft"><img src="pics/1blank.gif" width="0" height="0" /></td>
		<td class="newsColumnDigest">
		
		<table border="0" cellspacing="0" cellpadding="0">
		<tr>
<%
	if ( _doc.document_id == curObjectID )
	{
%>		
			<td class="LeftPanelSelectedItem"><img src="pics/1blank.gif" width="0" height="0" border="0"/></td>	
			<td width="auto" class="selectedLeftMenuItem"><%=_doc.name%></td>
			<td class="LeftPanelSelectedItemRight"><img src="pics/1blank.gif" width="0" height="0" border="0"/> </td>
<%
	}
	else
	{
%>
			<td class="LeftPanelNoSelectedItem"><img src="pics/1blank.gif" width="0" height="0" border="0"/></td>
			<td width="auto"><a class="LeftMenuItem" href="view_doc.html?mode=<%=curRefMode%>&doc_id=<%=curDocID%>&object_id=<%=_doc.document_id%>"><%=_doc.name%></a></td>
			<td class="LeftPanelNoSelectedItemRight"><img src="pics/1blank.gif" width="0" height="0" border="0"/></td>
<%
	}
%>
			</tr>
		</table>
		
		</td> 
		<td class="newsColumnDigestRight"><img src="pics/1blank.gif" width="0" height="0" border="0"/></td>
	</tr> 
<%
}
%>
	<tr> 
		<td class="tableLeftFooter" colspan="3"><img src="pics/1blank.gif" width="0" height="0" /></td> 
	</tr> 
</table>
<%
parentObjectArray = ArraySort( ArraySelect( parentAllDocumentArray, 'parent_object_id.HasValue' ), 'parent_object_type', '+' );
parentObjectArrayNum = ArrayCount( parentObjectArray );

if ( parentObjectArrayNum != 0 )
{
	typeCounter = 0;
	curParentObject = parentObjectArray[ typeCounter ];

	while ( typeCounter < parentObjectArrayNum )
	{
		prevType = curParentObject.parent_object_type.Value;
%>
<br/>
<table class="leftPanelTable" width="100%" border="0" cellspacing="0" cellpadding="0"> 
	<tr> 
		<td class="tableLeftHeader" colspan="3"><div class="headerText" style="margin-top:10px;margin-bottom:5px;margin-left:5px;"><%=curLngCommon.exchange_object_types.GetChildByKey( prevType ).title%></div></td> 
	</tr> 
<%
		while ( prevType == curParentObject.parent_object_type )
		{
			prevType = curParentObject.parent_object_type.Value;
%>
	<tr> 
		<td class="newsColumnDigestLeft"><img src="pics/1blank.gif" width="0" height="0" /></td>
		<td class="horDivider"><img src="pics/1blank.gif" width="0" height="0" /></td> 
		<td class="newsColumnDigestRight"><img src="pics/1blank.gif" width="0" height="0" /></td>
	</tr> 
	<tr> 
		<td class="newsColumnDigestLeft"><img src="pics/1blank.gif" width="0" height="0" /></td>
		<td class="newsColumnDigest">
		
		<table border="0" cellspacing="0" cellpadding="0">
		<tr>
<%
			if ( curParentObject.document_id == curObjectID )
			{
%>		
			<td class="LeftPanelSelectedItem"><img src="pics/1blank.gif" width="0" height="0" border="0"/></td>	
			<td width="auto" class="selectedLeftMenuItem"><%=curParentObject.parent_object_name%></td>
			<td class="LeftPanelSelectedItemRight"><img src="pics/1blank.gif" width="0" height="0" border="0"/> </td>
<%
			}
			else
			{
%>
			<td class="LeftPanelNoSelectedItem"><img src="pics/1blank.gif" width="0" height="0" border="0"/></td>
			<td width="auto"><a class="LeftMenuItem" href="view_doc.html?mode=<%=curRefMode%>&doc_id=<%=curDocID%>&object_id=<%=curParentObject.document_id%>"><%=curParentObject.parent_object_name%></a></td>
			<td class="LeftPanelNoSelectedItemRight"><img src="pics/1blank.gif" width="0" height="0" border="0"/></td>
<%
			}
%>
			</tr>
		</table>
		
		</td> 
		<td class="newsColumnDigestRight"><img src="pics/1blank.gif" width="0" height="0" border="0"/></td>
	</tr> 
<%
			typeCounter++;
			if (  typeCounter >= parentObjectArrayNum )
				break;
			
			curParentObject = parentObjectArray[ typeCounter ];
		}
%>
	<tr> 
		<td class="tableLeftFooter" colspan="3"><img src="pics/1blank.gif" width="0" height="0" /></td> 
	</tr> 
</table>
<%
	}
}
%>