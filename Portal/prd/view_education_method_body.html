<%Server.Execute( "view_desc.html" )%>
		
<br>	
<TABLE width="100%" cellspacing="0" cellpadding="4" CLASS="tableBorder">			
	<TR>
		<TD WIDTH="200" ALIGN="RIGHT"><%=tools.get_web_str('c_name')%>:</TD>
		<TD STYLE="font-weight:normal"><%=tools_web.get_cur_lng_name( curObject.name )%></TD>
	</TR>
	<TR>
		<TD WIDTH="200" ALIGN="RIGHT"><%=tools.get_web_str('c_type')%>:</TD>
		<TD STYLE="font-weight:normal"><%=curLngCommon.education_method_types.GetChildByKey( curObject.type ).name%></TD>
	</TR>
<%
	if ( curObject.type == 'org' )
	{
%>
	<TR>
		<TD WIDTH="200" ALIGN="RIGHT"><%=tools.get_web_str('c_edu_org')%>:</TD>
		<TD STYLE="font-weight:normal">
<%
	try
	{
		if ( curObject.education_org_id.HasValue )
		{
			_cur_education_org = curObject.education_org_id.ForeignElem;
%>
			<a HREF="view_doc.html?mode=education_org&doc_id=<%=curDocID%>&object_id=<%=curObject.education_org_id%>" title="<%=tools.get_web_str('c_tip_edu_org')%>"><%=tools_web.get_cur_lng_name( _cur_education_org.disp_name )%></a>
<%
		}		
	}
	catch ( ll )
	{
%>
			<font color="#FF0033"><%=tools.get_web_str('c_deleted')%></font>
<%
	}
%>
		</TD>		
	</TR>	
<%
	}
	else
	{
%>
	<TR>
		<TD WIDTH="200" ALIGN="RIGHT"><%=tools.get_web_str('c_course')%>:</TD>
		<TD STYLE="font-weight:normal">
<%
	try
	{
		if ( curObject.course_id != null )
		{
			_cur_course = curObject.course_id.ForeignElem;
%>
			<a HREF="view_doc.html?mode=course_info&doc_id=<%=curDocID%>&object_id=<%=curObject.course_id%>" title="<%=tools.get_web_str('c_tip_course')%>"><%=tools_web.get_cur_lng_name( _cur_course.name )%></a>
<%
		}		
	}
	catch ( ll )
	{
%>
			<font color="#FF0033"><%=tools.get_web_str('c_deleted')%></font>
<%
	}
%>	
		</TD>	
	</TR>
<%
	}
%>	
	<TR>
		<TD>&nbsp;</TD>
	</TR>
	<TR>
		<TD WIDTH="200" ALIGN="RIGHT"><%=tools.get_web_str('c_hour_duration')%>:</TD>
		<TD STYLE="font-weight:normal"><%=curObject.duration%></TD>
	</TR>
	<TR>
		<TD WIDTH="200" ALIGN="RIGHT"><%=tools.get_web_str('c_person_num')%>:</TD>
		<TD STYLE="font-weight:normal"><%=curObject.person_num%></TD>
	</TR>
<%
	if ( curObject.cost.HasValue )
	{
%>	
	<TR>
		<TD WIDTH="200" ALIGN="RIGHT"><%=tools.get_web_str('c_cost')%>:</TD>
		<TD STYLE="font-weight:normal">
<%
		Response.Write( curObject.cost );
		try
		{
			Response.Write( ' ' + curObject.currency.ForeignElem.name );
		}
		catch ( rr )
		{
		}
		try
		{
			Response.Write( ' ' + curLngCommon.cost_types.GetChildByKey( curObject.cost_type ).name );
		}
		catch ( rr )
		{
		}
%>
		</TD>
	</TR>
<%
	}
%>	
</TABLE>
<BR/>
<%
	if ( curObject.is_open )
	{
%>			
<TABLE width="100%" cellspacing="0" cellpadding="4" CLASS="activator">
	<TR VALIGN="MIDDLE">
		<TD COLSPAN="2" ALIGN="CENTER">
			<%=tools.get_web_str('c_text_create_request')%>:&nbsp;			
<%
			_request_type_array = XQuery( "for $elem in request_types where $elem/object_type = 'education_method' return $elem" )
			for ( _request_type in _request_type_array )
			{
%>	
			<input type="button" value="<%=HtmlEncode( tools_web.get_cur_lng_name( _request_type.name ) )%>" onClick="document.location.href='view_doc.html?mode=request_create&doc_id=<%=curDocID%>&type=education_method&request_object_id=<%=curObjectID%>&request_type_id=<%=_request_type.PrimaryKey%>';return false;" CLASS="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';">	
<%
			}
%>		
		</TD>
	</TR>
</TABLE>
<BR/>
<%
	}


	listLectors = curObject.lectors;
	Server.Execute( "view_list_lectors.html" );
	
	curQueryString = tools_web.get_query_string( true, 'last_from_cur_date' );	
	
	lastFromCurDate = Request.Query.HasProperty( 'last_from_cur_date' ) ? Request.Query.last_from_cur_date == '1' : true;
%>
<BR/>
<BR/>

<a href="last_from_cur_date_anchor" id="last_from_cur_date_anchor"></a>
<table width="100%" cellspacing="0" cellpadding="4" class="tableBorder">
	<tr>		
		<td width="200">&nbsp;</td>
		<td align="LEFT" style="font-weight:normal"><input type="checkbox" name="last_from_cur_date" <%=( lastFromCurDate ? 'checked="checked"' : '' )%> onclick="document.location.href='<%=curQueryString%>last_from_cur_date='+(this.checked?'1':'0')+'#last_from_cur_date_anchor'" /><%=tools.get_web_str('vemb_last_from_cur_date')%></td>
	</tr> 
</table>
<%
	curView = new Object;
	curView.SetProperty( 'id', '1' );
	curView.SetProperty( 'catalog_name', 'event' );
	curView.SetProperty( 'disp_link', 'true' );
	curView.SetProperty( 'link_field_index', 1 );
	curView.SetProperty( 'sort_index', 4 );
	curView.SetProperty( 'sort_direct', '-' );
	
	_date_str = lastFromCurDate ? " and $elem/start_date > date('" + CurDate + "')" : '';
	curEventArray = XQuery( "for $elem in events where $elem/education_method_id = " + curObjectID + _date_str + " return $elem" );

	if ( curUser.access.access_role != 'admin' )
	{
		curUserEventArray = XQuery( "for $elem in event_collaborators where $elem/collaborator_id = " + curUserID + _date_str + " return $elem" );
		curLectorEventArray = XQuery( "for $elem in event_lectors where $elem/person_id = " + curUserID + _date_str + " return $elem" );
		curEventArray = ArraySelect( curEventArray, "is_public || ArrayOptFind(curUserEventArray,'event_id=='+PrimaryKey)!=undefined || ArrayOptFind(curLectorEventArray,'event_id=='+PrimaryKey)!=undefined" );
	}

	curView.SetProperty( 'array', curEventArray );
	
	Server.Execute( 'view_catalog_list.html' );
%>
<BR/>
	
<%
	curKnowlegedDoc = curObject;
	Server.Execute( "view_knowledge_parts_body.html" );
%>