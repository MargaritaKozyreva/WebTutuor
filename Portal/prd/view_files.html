<%
try
{
	_files
}
catch ( e )
{
	try
	{
		_files = curFilesDoc.files;
	}
	catch ( e )
	{
		if ( curObjectID == null )
			_files = curDoc.files;
		else
			_files = curObject.files;
	}
}

try
{
	if ( dispDelete == true )
	{
		_colspan = 3;
	}
}
catch ( e )
{
	dispDelete = false;
	_colspan = 2;
}

dispTable = true
try
{
	 dispTable =(_files.ChildNum != 0 )

}
catch ( e )
{
	dispTable =(ArrayOptFirstElem(_files)!= undefined )
}
	
if ( dispTable )
{
%>
<table width="100%" CLASS="tableBasic" border="0" cellspacing="0" cellpadding="0">
	<tr>
		<td class="tableHeaderTextLeft"><img src="pics/1blank.gif" width="0" height="0" /></td>
		<td class="tableHeaderText" colspan="<%=_colspan%>"><p class="tableHeaderTextInner"><%=tools.get_web_str('vdb_files')%></p></td>
		<td class="tableHeaderTextRight"><img src="pics/1blank.gif" width="0" height="0" /></td>
	</tr>
	<tr>
		<td class="tableHeaderWithTextLeft"><img src="pics/1blank.gif" width="0" height="0" /></td>
		<td class="tableHeaderWithText" width="40%"><%=tools.get_web_str('c_name')%></td>
		<td class="tableHeaderWithText" width="60%"><%=tools.get_web_str('c_desc')%></td>
<%
	if ( dispDelete )
	{
%>
		<td class="tableHeaderWithText" width="50px"><%=tools.get_web_str('c_delete')%></td>
<%
	}
%>
		<td class="tableHeaderWithTextRight"><img src="pics/1blank.gif" width="0" height="0" /></td>
	</tr>
	<tr>
		<td class="tableHeaderNoTextLeft"><img src="pics/1blank.gif" width="0" height="0" /></td>
		<td class="tableHeaderNoText" colspan="<%=_colspan%>"><img src="pics/1blank.gif" width="0" height="0" /></td>
		<td class="tableHeaderNoTextRight"><img src="pics/1blank.gif" width="0" height="0" /></td>
	</tr>
<%
	counter = 0;				
	for ( _file in _files )
	{
		_class = counter++ % 2 ? 'tableRowEven' : 'tableRowOdd';
		_classl = counter++ % 2 ? 'tableRowEvenLeft' : 'tableRowOddLeft';		
		_classr = counter++ % 2 ? 'tableRowEvenRight' : 'tableRowOddRight';
%>
	<tr>
		<td class="<%=_classl%>"></td>
<%			
		try
		{
			_cur_file = _file.file_id.ForeignElem;
%>
		<TD class="<%=_class%>"><IMG src="pics/ex.gif" width="13" height="11">&nbsp;<A href="#" onClick="document.location.href='download_file.html?file_id=<%=_file.file_id%>&sid=<%=tools.get_sum_sid( _file.file_id )%>'"><%=_cur_file.name%></A></TD>
		<TD class="<%=_class%>"><%=_cur_file.comment%></TD>
<%
			if ( dispDelete )
			{
%>
		<td class="<%=_class%>"><center><input type="checkbox" name="delete_elem_<%=_file.PrimaryKey%>"/></center></td>
<%
			}
		}
		catch ( jh )
		{
%>
		<td class="<%=_class%>" colspan="<%=_colspan%>"><font color="#FF0000"><%=tools.get_web_str('c_deleted')%></font></td>
<%
		}
%>
		<td class="<%=_classr%>"></td>
	</tr>
<%	
	}
%>
	<tr>
		<td class="tableFooterLeft"><img src="pics/1blank.gif" width="0" height="0" /></td>
		<td class="tableFooter" colspan="<%=_colspan%>"><img src="pics/1blank.gif" width="0" height="0" /></td>
		<td class="tableFooterRight"><img src="pics/1blank.gif" width="0" height="0" /></td>
	</tr>
</table>
<%
}
%>