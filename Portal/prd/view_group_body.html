<table width="100%" cellspacing="0" cellpadding="4" class="tableBorder">
	<tr>		
		<td width="170" align="RIGHT"><%=tools.get_web_str('c_code')%>:</td>
		<td align="LEFT" style="font-weight:normal;"><%=curObject.code%></td>
	</tr>
</table>

<br/>
<%Server.Execute( "view_desc.html" );%>
<br />
<%
	_tut = ( curObject.func_managers.ChildByKeyExists( curUserID ) || curUser.access.access_role == 'admin' );
	if ( _tut )
	{
%>			
<table width="100%" cellspacing="0" cellpadding="5" class="activator">
	<tr valign="MIDDLE">
		<td align="CENTER"><input type="button" name="go" value="<%=tools.get_web_str('vgb_create_event')%>" onclick="document.location.href='event_create.html?doc_id=<%=curDocID%>&group_id=<%=curObjectID%>&sid=<%=tools.get_sum_sid( curDocID )%>'" class="inputButton" onmouseover="this.className='inputButtonOver';" onmouseout="this.className='inputButton';" /></td>
	</tr>
</table>
<br>
<%
	}
if(curObject.show_detailed && (0 < ArrayCount(curObject.func_managers)))	
{
%>
<h3><%=tools.get_web_str('c_managers')%></h3>
    <table width="100%"  border="0" cellspacing="0" cellpadding="3">
        <tr>
            <td class="tableHeaderWithText"><%=tools.get_web_str('c_fio')%></td>
            <td class="tableHeaderWithText"><%=tools.get_web_str('c_position')%></td>
            <td class="tableHeaderWithText"><%=tools.get_web_str('c_manager_type')%></td>
        </tr>
        <tr>
            <td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
            <td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
            <td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
        </tr>
    <%
        counter = 0;
        for ( _person in curObject.func_managers )
        {
            _class = counter++ % 2 ? 'tableRowEven' : 'tableRowOdd';
    %>
        <tr valign="MIDDLE">
            <td class="<%=_class%>"><a href="view_doc.html?mode=collaborator&doc_id=<%=curDocID%>&object_id=<%=_person.PrimaryKey%>"><%=_person.person_fullname%></a></td>
            <td class="<%=_class%>"><%=_person.person_position_name%></td>
            <td class="<%=_class%>"><%=( oBType = _person.boss_type_id.OptForeignElem, oBType == undefined ? tools.get_web_str('c_deleted') : oBType.name )%></td>
        </tr>
    <%
        }
    %>
        <tr>
            <td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
            <td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
            <td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
        </tr>
    </table>
<%

    curView = new Object;
    array = QueryCatalogByKeys( 'collaborators', 'id', ArrayExtract( curObject.collaborators , 'collaborator_id' ) );
    if(0 < ArrayCount(array))
    {    
        curView.SetProperty( 'title', tools.get_web_str('c_members'));
        curView.SetProperty( 'catalog_name', 'collaborator' );
        curView.SetProperty( 'disp_sort', 'false' );
        curView.SetProperty( 'disp_link', 'true' );
        curView.SetProperty( 'disp_search', 'false' );
        curView.SetProperty( 'disp_filter', 'false' );
        curView.SetProperty( 'link_field_index', 0 );
        curView.SetProperty( 'sort_index', 0 );
        curView.SetProperty( 'sort_direct', '-' );
        curView.SetProperty( 'link_mode', 'collaborator' );
        curView.SetProperty( 'array', array );
        curView.SetProperty( 'list_columns', Array('fullname','position_name','email') );
        curView.SetProperty( 'list_headers', Array(tools.get_web_str('c_fio'),tools.get_web_str('c_position'),'E-mail') );
        Server.Execute( 'view_catalog_list.html' );
    }
	
}
	if ( curObject.forum_id != null )
	{
%>			
<table width="100%" cellspacing="0" cellpadding="5" class="activator">
	<tr valign="MIDDLE">
		<td colspan="2" align="CENTER"><a href="view_doc.html?mode=forums&doc_id=<%=curDocID%>&object_id=<%=curObject.forum_id%>"><b><%=tools.get_web_str('vgb_go_forum')%></b></a></td>
	</tr>
</table>
<br>
<%
	}
%>