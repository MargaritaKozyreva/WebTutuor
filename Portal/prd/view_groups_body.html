<%
curView = new Object;
curView.SetProperty( 'catalog_name', 'group' );
curView.SetProperty( 'disp_link', 'true' );
curView.SetProperty( 'link_field_index', 1 );
curView.SetProperty( 'sort_index', 1 );

if ( curUser.access.access_role != 'admin' )
	curView.SetProperty( 'array', ArraySelectDistinct( ArrayUnion(
		QueryCatalogByKeys( 'groups', 'id', ArrayExtract( XQuery( 'for $elem in group_collaborators where $elem/collaborator_id = ' + curUserID + ' return $elem' ), 'group_id' ) ),
		QueryCatalogByKeys( 'groups', 'id', ArrayExtract( XQuery( "for $elem in func_managers where $elem/person_id = " + curUserID + " and $elem/catalog = 'group' return $elem" ), 'object_id' ) )
		), 'id' ) );

	
Server.Execute( 'view_catalog_list.html' );
%>
<br>