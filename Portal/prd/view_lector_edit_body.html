<%	try	{		curLectorID = Int( Request.QueryString.object_id );		curLector = OpenDoc( UrlFromDocID( curLectorID ) ).TopElem;	}	catch(_fuck_)	{		curLector = null;		curLectorID = null;	}	try	{		Session.RETURN_MSG;	}	catch(_x_)	{		Session.RETURN_MSG = "";	}	if (Session.RETURN_MSG != "")	{		Response.Write("<br/><center><font size='+1' align='center'><i><b>" + HtmlEncode(Session.RETURN_MSG) + "</b></i></font></center>");		Session.RETURN_MSG = "";	}%><script src="scripts/calendar/calendar.js"></script><script language="javascript"><!--//------------------------------------------------------------------------------------------function buttonMouseOver(){	window.event.srcElement.className='inputButtonOver';}function buttonMouseOut(){	window.event.srcElement.className='inputButton';}function checkkey(srcobj, keycode, flag_flat){				if ((keycode<48 || keycode>57)& keycode!=46) return false;	if (keycode==46) 	{		if( (!flag_flat) || srcobj.value.indexOf('.') >= 0) return false;	}	return true;}//------------------------------------------------------------------------------------------function what2submit(){	var sType = $("form#lector_submitter input:radio[name='type']:checked").val();	if (sType == "collaborator")	{		if ($("form#lector_submitter input#person_id").val() == "")		{			window.alert(<%=CodeLiteral( tools_web.get_web_str('vleb_mess_empty_coll') )%>);			return false;		}	}	else if (sType == "invitee")	{		if ($("form#lector_submitter input#last_name").val() == "")		{			window.alert(<%=CodeLiteral( tools_web.get_web_str('vleb_mess_empty_lastname') )%>);			return false;		}	}	else	{		window.alert(<%=CodeLiteral( tools_web.get_web_str('vleb_mess_empty_type') )%>);		return false;	}	return true;}//--------------------------------------------------------------------------------------------></script><table width="100%"  border="0" cellspacing="0" cellpadding="3" name="top_report_table"><tr><td><form name="lector_submitter" id="lector_submitter" action="content_panel_process.html" method="post"><input type="hidden" name="lector_id" value="<%=(curLectorID != null ? curLectorID : 0)%>"/><input type="hidden" name="mode" value="lector"/><input type="hidden" name="doc_id" value="<%=curDocID%>"/><input type="hidden" name="href" value="<%=Request.Url%>"/><%	Server.Execute( "view_tinymce.html" );%><input type="radio" id="type_invitee" name="type" value="invitee" <%=(curLector == null || curLector.type == "invitee"? "checked" : "")%> onclick="$('form#lector_submitter table#person_block_table').hide('fast');$('form#lector_submitter table#fullname_block_table').show('fast');"/><%=tools_web.get_web_str('vleb_invitee_lector')%> &nbsp;&nbsp;<input type="radio" id="type_collaborator" name="type" value="collaborator" <%=(curLector != null && curLector.type == "collaborator"? "checked" : "")%> onclick="$('form#lector_submitter table#person_block_table').show('fast');$('form#lector_submitter table#fullname_block_table').hide('fast');"/><%=tools_web.get_web_str('c_coll')%><br/><table width="100%" id="person_block_table" style="display: <%=(curLector != null && curLector.type == "collaborator"? "inline" : "none")%>">	<tr valign="middle">		<td  width="100%">			<input type="text" id="person_fullname" name="person_fullname" value="<%=(curLector != null ? HtmlEncode(curLector.person_fullname) : "")%>" class="inputEdit" style="width:100%" readonly/>			<input type="hidden" name="person_id" id="person_id" value="<%=(curLector != null ? curLector.person_id : "")%>"/>		</td>		<td>			<input type="button" value="..." class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';" onclick="					var pars=new Object(); pars.check_access = true;					var strAttr='status:no;dialogWidth:780px;dialogHeight:550px;help:no;resizable:1';					xShowModalDialog('dlg_select.html?doc_id=<%=curDocID%>&catalog_name=collaborator&typein=1&multi_select=0&rand='+Math.random(), pars, strAttr);					if (!pars.handle ) return false;										document.getElementById('person_id').value = pars.element_id;					document.getElementById('person_fullname').value = pars.element_name;				" style="width: 25px"/>		</td>	</tr></table><table width="100%" cellspacing="0" cellpadding="4" class="tableBorder" border="0" id="fullname_block_table" style="display: <%=(curLector == null || curLector.type == "invitee"? "inline" : "none")%>">	<tr>		<td style="font-weight:bolder; font-size:larger;" width="100px"><%=tools_web.get_web_str('uf_last_name')%>:</td>		<td style="font-weight:bolder; font-size:larger"><input type="text" id="lastname" name="lastname" value="<%=(curLector != null ? HtmlEncode(curLector.lastname) : "")%>" class="inputEdit" style="width:100%"/></td>	</tr>	<tr>		<td style="font-weight:bolder; font-size:larger;" width="100px"><%=tools_web.get_web_str('uf_name')%>:</td>		<td style="font-weight:bolder; font-size:larger"><input type="text" id="firstname" name="firstname" value="<%=(curLector != null ? HtmlEncode(curLector.firstname) : "")%>" class="inputEdit" style="width:100%"/></td>	</tr>	<tr>		<td style="font-weight:bolder; font-size:larger;" width="100px"><%=tools_web.get_web_str('uf_s_name')%>:</td>		<td style="font-weight:bolder; font-size:larger"><input type="text" id="middlename" name="middlename" value="<%=(curLector != null ? HtmlEncode(curLector.middlename) : "")%>" class="inputEdit" style="width:100%"/></td>	</tr>	<tr>		<td style="font-weight:bolder; font-size:larger;" width="100px"><%=tools_web.get_web_str('vpb_sex')%>:</td>		<td style="font-weight:bolder; font-size:larger">			<input type="radio" id="sex_male" name="sex" value="m" <%=(curLector == null || curLector.sex == "m" ? "checked" : "")%>/>&nbsp;<%=tools_web.get_web_str('vpb_m')%>&nbsp;&nbsp;&nbsp;<input type="radio" id="sex_fem" name="sex" value="w" <%=(curLector != null && curLector.sex == "w" ? "checked" : "")%>/>&nbsp;<%=tools_web.get_web_str('vpb_w')%>		</td>	</tr>	<tr>		<td style="font-weight:bolder; font-size:larger;" width="100px"><%=tools_web.get_web_str('vpb_birthday')%>:</td>		<td style="font-weight:bolder; font-size:larger">			<TABLE cellpadding="0" cellspacing="2">			<tr>				<td>					<input type="text" id="birth_date" name="birth_date" value="<%=(curLector != null ? curLector.birth_date : "")%>" class="inputEdit" style="width:100px" readonly/>				</td>				<td>					<a href="#" onclick="var h=0; var offP = this.offsetParent; while(offP.id != 'main_block' && offP.tagName.toUpperCase()!='BODY') {h+=offP.offsetTop; offP = offP.offsetParent;} ; showCalendar(this, document.getElementById('birth_date'), 'dd.mm.yyyy','ru',1,null, h+40); return false;"><img src="/scripts/calendar/calendar.gif" width="24" height="22" border="0"/></a>				</td>				<td valign="middle">					<input type="button" value="x" title="<%=tools.get_web_str("c_clear_field")%>" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';" onclick="document.getElementById('birth_date').value = '';" style="width: 25px"/>				</td>			</tr>			</TABLE>		</td>	</tr></table><br/><input type="checkbox" value="1" name="allow_publication" <%=(curLector != null && curLector.allow_publication ? "checked" : "")%>/>&nbsp;<%=tools_web.get_web_str('vleb_can_public')%><br/><table width="100%" style="font-weight:bolder; font-size:larger;">	<tr>		<td><%=tools.get_web_str('c_desc')%></td>	</tr><tr>		<td><textarea id="desc" name="desc" style="width:100%; height: 300px"><%=(curLector != null ? HtmlEncode(curLector.desc) : "")%></textarea></td>	</tr></table><br/><table width="100%" border="0" cellspacing="0" cellpadding="3">	<tr>		<td class="tableHeaderWithTextLeft"><img src="pics/1blank.gif" width="0" height="0" /></td>		<td class="tableHeaderWithText" width="100%"><%=tools_web.get_web_str('vepb_edu_methods')%></td>		<td class="tableHeaderWithTextRight"><img src="pics/1blank.gif" width="0" height="0" /></td>	</tr>	<tr>		<td class="tableHeaderWithTextLeft"><img src="pics/1blank.gif" width="0" height="0" /></td>		<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1"/></td>		<td class="tableHeaderWithTextRight"><img src="pics/1blank.gif" width="0" height="0" /></td>	</tr>	<tbody id="edumethodlist"><%		iCounter = 0;		if (curLectorID != null)		for (catEduMethodLector in XQuery("for $elem in education_method_lectors where $elem/lector_id = " + curLectorID + " return $elem"))		{			sClass = iCounter++ % 2 ? 'tableRowEven' : 'tableRowOdd';			sClassL = iCounter++ % 2 ? 'tableRowEvenLeft' : 'tableRowOddLeft';					sClassR = iCounter++ % 2 ? 'tableRowEvenRight' : 'tableRowOddRight';%>		<tr>			<td class="<%=sClassL%>"></td>								<td class="<%=sClass%>" colspan="2">				<a href="view_doc.html?mode=education_method&object_id=<%=catEduMethodLector.education_method_id%>&doc_id=<%=curDocID%>"><%=catEduMethodLector.name%></a>			</td>			<td class="<%=sClassR%>"></td>		</tr><%			}%>	</tbody>	<tr>		<td class="tableFooterLeft"><img src="pics/1blank.gif" width="0" height="0" /></td>		<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>		<td class="tableFooterRight"><img src="pics/1blank.gif" width="0" height="0" /></td>	</tr></table><br/><table width="100%"  border="0" cellspacing="0" cellpadding="3">	<tr>		<td class="tableHeaderWithTextLeft"><img src="pics/1blank.gif" width="0" height="0" /></td>		<td class="tableHeaderWithText" width="100%"><%=tools_web.get_web_str('c_events')%></td>		<td class="tableHeaderWithTextRight"><img src="pics/1blank.gif" width="0" height="0" /></td>	</tr>	<tr>		<td class="tableHeaderWithTextLeft"><img src="pics/1blank.gif" width="0" height="0" /></td>		<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1"/></td>		<td class="tableHeaderWithTextRight"><img src="pics/1blank.gif" width="0" height="0" /></td>	</tr>	<tbody id="eventlist"><%		iCounter = 0;		if (curLectorID != null)		for (catEventLector in XQuery("for $elem in event_lectors where $elem/lector_id = " + curLectorID + " return $elem"))		{			sClass = iCounter++ % 2 ? 'tableRowEven' : 'tableRowOdd';			sClassL = iCounter++ % 2 ? 'tableRowEvenLeft' : 'tableRowOddLeft';					sClassR = iCounter++ % 2 ? 'tableRowEvenRight' : 'tableRowOddRight';%>		<tr>			<td class="<%=sClassL%>"></td>								<td class="<%=sClass%>" colspan="2">				<a href="view_doc.html?mode=event&object_id=<%=catEventLector.event_id%>&doc_id=<%=curDocID%>"><%=catEventLector.name%></a>			</td>			<td class="<%=sClassR%>"></td>		</tr><%			}%>	</tbody>	<tr>		<td class="tableFooterLeft"><img src="pics/1blank.gif" width="0" height="0" /></td>		<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>		<td class="tableFooterRight"><img src="pics/1blank.gif" width="0" height="0" /></td>	</tr></table>	<br/>		<center><input type="submit" value="<%=tools.get_web_str('c_save')%>" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';" onclick="return what2submit();"/></center></form><%	_href = tools_web.get_url_protocol( Request.Url ) + Request.UrlHost + UrlPath( Request.Url ) + "?mode=content_panel&doc_id="+curDocID+"&tab=lector";%><center>	<input type="button" value="<%=tools_web.get_web_str('vaaeb_list_back')%>" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';" onclick="window.location.href='<%=_href%>'"/></center><br/></td></tr><tr>	<td colspan="3" class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td></tr></table>