<%
try
{
	curDoc.name;

	try
	{
		//_forum_array = XQuery( 'for $forum in forums where $forum/document_id = ' + curDocID + ' order by $forum/name return $forum' );
		
		_forum_array = Array();
		_catalogs = curDoc.catalogs;
		for ( _catalog in _catalogs )
		{
			if ( _catalog.type != 'forum' )
				continue;
				
			if ( _catalog.all )
				_forum_array = XQuery( 'for $forum in forums order by $forum/name return $forum' );
			else
				_forum_array = QueryCatalogByKeys( 'forums', 'id',  ArrayExtract( _catalog.objects, "PrimaryKey" ) );
		}
	}
	catch ( cc )
	{
		_forum_array = Array();
	}
	
	if ( ArrayOptFirstElem( _forum_array ) != undefined )
	{
%>
<table class="leftPanelTable" width="100%" border="0" cellspacing="0" cellpadding="2"> 
	<tr> 
		<td class="tableLeftForumHeader" colspan="3"><div id="leftPanelForumHeaderText" class="LeftHeaderText" style="text-align: center;"><%=curDoc.name%></div></td> 
	</tr> 
<%
		for ( _forum in _forum_array )
		{
			if ( global_settings.settings.check_access_on_lists )
				try
				{
					if ( tools_web.check_access( OpenDoc( UrlFromDocID ( _forum.PrimaryKey ), 'form=x-local://wtv/wtv_form_doc_access.xmd;ignore-top-elem-name=1' ).TopElem, curUserID, curUser, Session ) == false )
						continue;
				}
				catch(_opa_)
				{
					continue;
				}
%>
	<tr> 
		<td class="horDivider" colspan="3"><img src="pics/1blank.gif" width="0" height="0" /></td> 
	</tr> 
  	<tr> 
		<td class="newsColumnDigestLeft"><img src="pics/1blank.gif" width="0" height="0" /></td>
		<td class="newsColumnDigest">
		
		<table width="100%" border="0" cellspacing="0" cellpadding="2">
			<tr>
<%
			if ( _forum.id == curObjectID )
			{
%>
				<td width="100%" class="selectedLeftMenuItem"><%=tools_web.get_cur_lng_name( _forum.name )%></td>
                <td><img src="pics/more.gif" width="14" height="14" border="0" align="absmiddle" /></td>	
<%
			}
			else
			{
%>
				<td width="100%"><a class="LeftMenuItem" href="view_doc.html?mode=forums&doc_id=<%=curDocID%>&object_id=<%=_forum.id%>"><%=tools_web.get_cur_lng_name( _forum.name )%></a></td>
                <td><img src="pics/1blank.gif" width="14" height="14" border="0" align="absmiddle" /></td>
<%
			}
%>
			</tr>
		</table>
		
		</td>
		<td class="newsColumnDigestRight"><img src="pics/1blank.gif" width="0" height="0" /></td>
	</tr> 
<%
		}
%>
	<tr> 
		<td class="tableLeftFooter" colspan="3"><img src="pics/1blank.gif" width="0" height="0" /></td> 
	</tr>
</table>

<%
	}
	else
	{
		Server.Execute( "view_left_panel.html" );
	}
}
catch ( eee )
{

}
%>