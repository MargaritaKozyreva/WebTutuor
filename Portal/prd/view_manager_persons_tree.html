<script src="scripts\tree\ua000000.js"></script>
<script src="scripts\tree\ftiens40.js"></script>
<script language="javascript">

USETEXTLINKS = 1;
STARTALLOPEN = 0;
USEFRAMES = 0;
USEICONS = 0;
WRAPTEXT = 1;
PRESERVESTATE = 1;
ICONPATH = "scripts\\tree\\";

foldersTree = gFld( "<img src=pics/folder.gif border=0>&nbsp;<b><%=tools.get_web_str('vmpb_all_subordinates')%></b>", "view_doc.html?mode=manager_persons&doc_id=<%=curDocID%>" );
<%
	curManagerArray = XQuery( 'for $elem in func_managers where $elem/person_id = ' + curUserID + ' return $elem' );
	
	selArray = ArraySelect( curManagerArray, "catalog=='collaborator'" );
	if ( ArrayCount( selArray ) != 0 )
	{
		selArrayNum = ArrayCount( selArray );
		Response.Write( 'personTree=insFld(foldersTree,gFld("<img src=pics/folder.gif border=0>&nbsp;<b>' + tools.get_web_str('c_coll') + '</b>&nbsp;(' + selArrayNum + ')"));\n' );
		if ( selArrayNum < 100 )
			for ( _elem in selArray )
				Response.Write( 'insDoc(personTree,gLnk("S","<img src=pics/person.gif border=0>&nbsp;' + HtmlEncode( tools_web.get_cur_lng_name( _elem.object_name ) ) + '","view_doc.html?mode=person&object_id=' + _elem.object_id + '&doc_id=' + curDocID + '"));\n' );
	}
	
	selArray = ArraySelect( curManagerArray, "catalog=='group'" );
	if ( ArrayCount( selArray ) != 0 )
	{
		selArrayNum = ArrayCount( selArray );
		Response.Write( 'personTree=insFld(foldersTree,gFld("<img src=pics/folder.gif border=0>&nbsp;<b>' + tools.get_web_str('c_group') + '</b>&nbsp;(' + selArrayNum + ')"));\n' );
		for ( _elem in selArray )
			Response.Write( 'insDoc(personTree,gLnk("S","<img src=pics/group.gif border=0>&nbsp;' + HtmlEncode( tools_web.get_cur_lng_name( _elem.object_name ) ) + '","view_doc.html?mode=group&object_id=' + _elem.object_id + '&doc_id=' + curDocID + '"));\n' );
	}
	
	selArray = ArraySelect( curManagerArray, "catalog=='position'" );
	if ( ArrayCount( selArray ) != 0 )
		for ( _elem in selArray )
			Response.Write( 'insDoc(foldersTree,gLnk("S","<img src=pics/subdivision.gif border=0>&nbsp;' + HtmlEncode( tools_web.get_cur_lng_name( _elem.parent_id.ForeignElem.name ) ) + '","view_doc.html?mode=manager_persons&subdivision_id=' + _elem.parent_id + '&doc_id=' + curDocID + '"));\n' );
	
	selArray = ArraySelect( curManagerArray, "catalog=='subdivision'&&ArrayOptFind(selArray,'parent_id=='+object_id)==undefined" );
	if ( ArrayCount( selArray ) != 0 )
		for ( _elem in selArray )
			Response.Write( 'insDoc(foldersTree,gLnk("S","<img src=pics/subdivision.gif border=0>&nbsp;' + HtmlEncode( tools_web.get_cur_lng_name( _elem.object_name ) ) + '","view_doc.html?mode=manager_persons&subdivision_id=' + _elem.object_id + '&doc_id=' + curDocID + '"));\n' );
%>
</script>

<span class="TreeviewSpanArea" style="overflow:auto">
	<script>initializeDocument();</script>
</span>	