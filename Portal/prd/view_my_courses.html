<%

		_cardDoc = tools_web.get_my_person_object_link_card("course",curUserID);
	
		if (_cardDoc != undefined)
		{
			_item_allowed_pack = ArrayExtract(_cardDoc.objects, "PrimaryKey");
			if (_cardDoc.all_can_edit)
				_editable_list = "'*'";
			else
				_editable_list = CodeLiteral(ArrayMerge(ArraySelectByKey(_cardDoc.objects, true, "can_edit"), "This.PrimaryKey", ";"));
				
			if (_cardDoc.all_can_delete)
				_deletable_list = "'*'";
			else
				_deletable_list = CodeLiteral(ArrayMerge(ArraySelectByKey(_cardDoc.objects, true, "can_delete"), "This.PrimaryKey", ";"));
		}
		else
		{
			_item_allowed_pack = Array();
			_editable_list = "''";
			_deletable_list = "''";
		}
		_itemArray = QueryCatalogByKeys("courses", "id", _item_allowed_pack);
		
		curView = new Object;
		curView.SetProperty("id", "course_list");
		curView.SetProperty("catalog_name", "course");
		curView.SetProperty("disp_link", "("+_editable_list+"=='*' || StrContains("+_editable_list+",ListElem.PrimaryKey) ? true: false)");
		curView.SetProperty("disp_check_box", "true");
		curView.SetProperty("disp_check_box_visibility", "("+_deletable_list+"=='*' || StrContains("+_deletable_list+",ListElem.PrimaryKey) ? true: false)");
		curView.SetProperty("title", tools_web.get_web_str('c_courses') );
		curView.SetProperty("array", _itemArray);
		curView.SetProperty("link_mode", "course_edit");
		curView.SetProperty("link_field_index", 1);
		
		Server.Execute( "view_catalog_list.html" );
%>
<table cellspacing="0" cellpadding="1" border="0">
<tr>
<%	
	if (_cardDoc != undefined && _cardDoc.all_can_create)
	{
%>
<td>
		<form name="scorm_submitter" id="scorm_submitter" action="content_panel_process.html" method="post" enctype="multipart/form-data">
			<input type="hidden" name="mode" value="scorm_import"/>
			<input type="hidden" name="doc_id" value="<%=curDocID%>"/>
			<input type="hidden" name="href" value="<%=Request.Url%>"/>
			
			<input style="width: 500px;" type="file" name="scorm_file_url" id="scorm_file_url" value="" class="inputButton"/>&nbsp;<input type="submit" value="<%=tools_web.get_web_str('vmc_import')%>" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';" onclick="
				var _file_name = document.getElementById('scorm_file_url').value;
				if (_file_name == '') return false;
				var _ext = _file_name.substr(_file_name.lastIndexOf('.'));
				if (_ext != '.xml' && _ext != '.zip')
				{
					window.alert('<%=tools_web.get_web_str('vmc_mess_import')%>');
					return false;
				}
			"/>
		</form>
</td>
<%
	}
	if (_deletable_list != "''")
	{
%>
<td>
	<form name="course_killa" id="course_killa" action="content_panel_process.html" method="post">
		<input type="hidden" name="doc_id" value="<%=curDocID%>"/>
		<input type="hidden" name="href" value="<%=Request.Url%>"/>
		<input type="hidden" name="mode" value="delete_elements"/>
		<input type="hidden" name="catalog_name" value="course"/>
		<input type="hidden" name="dead_object_ids" value=""/>
		<input type="button" value="<%=tools.get_web_str('c_delete')%>" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';" onclick="
			var _str = '';
			var _dead_list = document.getElementsByName('select_check_box_course_list');
			var x =0;
			for (var i =0; i<_dead_list.length;i++)
			if (_dead_list[i].checked)
			{
				_str += (_str != '' ? ';': '') + _dead_list[i].id;
				x++;
			}
			document.forms['course_killa'].elements['dead_object_ids'].value = _str;
			if (_str != '' && confirm(String('<%=tools_web.get_web_str('vmc_mess_del_courses')%>').replace('{PARAM1}',x) ))
				document.forms['course_killa'].submit();
		"/>
	</form>
</td>
<%
	}
%>
</tr>
</table>