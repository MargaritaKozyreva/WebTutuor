<%
	try
	{
		_cur_date = DateNewTime( Date( Request.QueryString.date ) );
	}
	catch ( rr )
	{
		_cur_date = DateNewTime( Date() );
	}
	_num_days = Array( 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 );
	_year = Year( _cur_date );
	_month = Month( _cur_date );
	
	_date_start = Date( '1.' + _month + '.' + _year );
	_date_end = Date( '1.' + ( _month == 12 ? '1.' + ( _year + 1 ) : ( _month + 1 ) + '.' + _year ) );
	w = WeekDay( _date_start );
	_week_day = ( w == 0 ? 6 : w - 1 );
	_cur_num_days = _num_days[ _month - 1 ];
	
	curQueryString = tools_web.get_query_string( true, 'date;day' );
%>	
 
<a href="#CALENDAR1"></a>
<table cellpadding=0 cellspacing=0 border=0 width=100%>
<tr>
	<td class="calendarBodyTable">
	<table  cellpadding=0 cellspacing=0 border=0 width=100%>
		<tr>
			<td width=100% align=center class="calendarHeader">
				<a href="<%=( curQueryString + 'date=1.' + ( _month == 1 ? '12.' + ( _year - 1 ) : ( _month - 1 ) + '.' + _year ) + '#CALENDAR1' )%>">&lt;</a>&nbsp;<%=StrDate( _cur_date )%>&nbsp;<a href="<%=( curQueryString + 'date=' + _date_end + '#CALENDAR1' )%>">&gt;</a>
			</td>
		</tr>
	</table>
	<table cellpadding="0" cellspacing="1" border="0" width="100%" class="calendarInnerTable">
		<tr>
			<td width=15% align=center class="calendarDaysHeader"><%=tools.get_web_str('day_monday')%></td>
			<td width=15% align=center class="calendarDaysHeader"><%=tools.get_web_str('day_tuesday')%></td>
			<td width=15% align=center class="calendarDaysHeader"><%=tools.get_web_str('day_wednesday')%></td>
			<td width=15% align=center class="calendarDaysHeader"><%=tools.get_web_str('day_thursday')%></td>
			<td width=15% align=center class="calendarDaysHeader"><%=tools.get_web_str('day_friday')%></td>
			<td width=12% align=center class="calendarDaysHeader"><%=tools.get_web_str('day_saturday')%></td>
			<td width=12% align=center class="calendarDaysHeader"><%=tools.get_web_str('day_sunday')%></td>
		</tr>			
		<tr bgcolor="#FFFFFF">						
<%
	for ( i = 0; i < _week_day; i++ )
	{
%>			
			<td></td>
<%
	}

	for ( i = 1; i <= _cur_num_days; i++ )
	{
		_cur_date = Date( i + '.' + _month + '.' + _year );

		if ( _week_day == 0 )
		{
%>
		<tr>
<%
		}
%>	
			<td class="<%=( ArrayOptFind( curObjectResourceArray, 'DateNewTime( start_date ) == _cur_date' ) != undefined ? 'tableRowEvenHoll' : 'tableRowEvenEvery' )%>" onclick="window.location='<%=( curQueryString + 'date=' + _cur_date + '&day=' + i + '#CALENDAR1' )%>'"><%=i%></td>

<%
		_week_day++;		
		if ( _week_day == 7 )
		{
%>
		</tr>
<%
			_week_day = 0;
		}

	}

	a = 7 - _week_day;
	if ( _week_day )
		for ( i = 0; i < a; i++ )
		{
%>			
			<td></td>										
<%
			_week_day++;		
			if ( _week_day == 7 )
			{
%>
		</tr>
<%
			}
		}
%>							
					
	</table>
	</td>
</tr>
</table>