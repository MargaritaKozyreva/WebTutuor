<br/>
<%Server.Execute("view_text_area.html")%>

<table width="100%"  border="0" cellspacing="0" cellpadding="0">
	<tr>
		<td class="tableHeaderWithText" WIDTH="100"><%=tools.get_web_str('c_code')%></td>
		<td class="tableHeaderWithText"><%=tools.get_web_str('c_name')%></td>
		<td class="tableHeaderWithText" width="200"><%=tools.get_web_str('c_type')%></td>
		<td class="tableHeaderWithText"><%=tools.get_web_str('c_desc')%></td>
		<td class="tableHeaderWithText"><%=tools.get_web_str('c_place')%></td>
	</tr>
	<tr>
		<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
		<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
		<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
		<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
		<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="1" height="1" /></td>
	</tr>
<%
	_counter = 0;
	for ( _object_resource in XQuery( "for $elem in object_resources" + ( curObjectResourceType == '' ? "" : " where $elem/type = '" + curObjectResourceType + "'" ) + " order by $elem/name return $elem" ) )
	{
		_counter++;
		_class = _counter % 2 ? 'tableRowEven' : 'tableRowOdd';
		
		curObjectResource = OpenDoc( UrlFromDocID( _object_resource.PrimaryKey ) ).TopElem;
%>
	<TR>
		<TD class="<%=_class%>"><%=curObjectResource.code%></TD>
		<TD class="<%=_class%>"><a href="view_doc.html?mode=object_resource&doc_id=<%=curDocID%>&object_id=<%=_object_resource.PrimaryKey%>" title__="<%=tools.get_web_str('c_tip_place')%>"><%=tools_web.get_cur_lng_name( curObjectResource.name )%></a></TD>
		<TD class="<%=_class%>">
<%
		try
		{
			Response.Write( curObjectResource.type.HasValue ? tools_web.get_cur_lng_name( curObjectResource.type.ForeignElem.name ) : "" );
		}
		catch ( err )
		{
%>
			<FONT COLOR="#FF0033"><%=tools.get_web_str('c_deleted')%></FONT>
<%
		}
%>
		</TD>
		<TD class="<%=_class%>"><%=( curObjectResource.small_desc.HasValue ? tools_web.get_web_desc( curObjectResource.small_desc, UrlFromDocID( _object_resource.PrimaryKey ), 'object_resource.small_desc' ) : '' )%></TD>
		<TD class="<%=_class%>">
<%
		try
		{
			if ( curObjectResource.place_id.HasValue )
				Response.Write( tools_web.get_cur_lng_name( curObjectResource.place_id.ForeignElem.name ) );
		}
		catch ( err )
		{
%>
			<FONT COLOR="#FF0033"><%=tools.get_web_str('c_deleted')%></FONT>
<%
		}
%>
		</TD>
	</TR>
<%
	}
%>	
	<tr>
		<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
		<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
		<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
		<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
		<td class="tableFooter"><img src="pics/1blank.gif" width="1" height="1" /></td>
	</tr>
</table>
<br/>