<%
curActiveEventArray = XQuery( "for $event in event_collaborators where $event/collaborator_id = " + curUserID + " and $event/status_id != 'project' and $event/status_id != 'close' and $event/status_id != 'cancel' return $event" );
curActiveEventNum = ArrayCount( curActiveEventArray );

if ( curActiveEventNum != 0 )
{
	curView = new Object;
	curView.SetProperty( 'id', String( Random( 1, 99 ) ) );
	curView.SetProperty( 'catalog_name', 'event' );
	curView.SetProperty( 'disp_link', 'true' );
	curView.SetProperty( 'link_field_index', 1 );
	curView.SetProperty( 'sort_index', 4 );
	curView.SetProperty( 'sort_direct', '-' );
	curView.SetProperty( 'link_object_field', 'event_id' );
	curView.SetProperty( 'array', curActiveEventArray );
	curView.SetProperty( 'check_access', 'false' );
	try
	{
		curView.SetProperty( 'title', curListTitle );
	}
	catch ( amba )
	{
	}
	
	Server.Execute( 'view_catalog_list.html' );
}
%>
<br/>