<%
if ( ArrayCount( recommend_courses ) )
{
%>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
	<td class="tableHeaderTextLeft"><img src="pics/1blank.gif" width="0" height="0" /></td>
	<td class="tableHeaderText" colspan="2"><p class="tableHeaderTextInner"><%=tools.get_web_str('vrc_title')%></p></td>
	<td class="tableHeaderTextRight"><img src="pics/1blank.gif" width="0" height="0" /></td>
</tr>	
<tr class="tableHeaderWithTextRow">
	<td class="tableHeaderWithTextLeft"><img src="pics/1blank.gif" width="0" height="0" /></td>
	<td class="tableHeaderWithText" style="text-align: left"><%=tools.get_web_str('c_course')%></td>
	<td class="tableHeaderWithText" style="text-align: center"><%=tools.get_web_str('vllb_action')%></td>
	<td class="tableHeaderWithTextRight"><img src="pics/1blank.gif" width="0" height="0" /></td>
</tr>
<tr>
	<td class="tableHeaderNoTextLeft"><img src="pics/1blank.gif" width="0" height="0" /></td>
	<td class="tableHeaderNoText"><img src="pics/1blank.gif" width="0" height="0" /></td>
	<td class="tableHeaderNoText" width="140"><img src="pics/1blank.gif" width="0" height="0" /></td>
	<td class="tableHeaderNoTextRight"><img src="pics/1blank.gif" width="0" height="0" /></td>
</tr>
<%
	counter = 0;
	for ( _rec_course in recommend_courses )
	{
		_class = counter++ % 2 ? 'tableRowEven' : 'tableRowOdd';		
		_classl = counter++ % 2 ? 'tableRowEvenLeft' : 'tableRowOddLeft';		
		_classr = counter++ % 2 ? 'tableRowEvenRight' : 'tableRowOddRight';		
%>	
<tr>
	<td class="<%=_classl%>"></td>
<%
		try
		{
			_cur_course = _rec_course.course_id.ForeignElem;
%>
			
	<td class="<%=_class%>"><a href="view_doc.html?mode=course_info&object_id=<%=_rec_course.course_id%>&doc_id=<%=curDocID%>"><%=_cur_course.code%>&nbsp;<%=tools_web.get_cur_lng_name( _cur_course.name )%></a></td>
	<td align="CENTER" class="<%=_class%>" width="140">
<%
			if ( ArrayCount( XQuery( 'for $active_learning in active_learnings where $active_learning/person_id = ' + curUserID + ' and $active_learning/course_id = ' + _rec_course.course_id + ' return $active_learning' ) ) )
			{
                Response.Write( tools.get_web_str('vanb_active') );
			}
			else if ( _cur_course.yourself_start )
			{
%>
		<input type="button" value="<%=tools.get_web_str('vcorb_b_start')%>" class="inputButton" onmouseover="this.className='inputButtonOver';" onmouseout="this.className='inputButton';" style="width:140px " onclick="location.href='course_activate.html?course_id=<%=_rec_course.course_id%>&sid=<%=tools.get_sum_sid( _rec_course.course_id )%>';return false;">
<%
			}
			else
			{
			
			fldRequestType = ArrayOptFirstElem(XQuery( "for $elem in request_types where $elem/object_type = 'course' return $elem" ))
			strRequestTupe='';
			if (fldRequestType!=undefined)
			{
				strRequestTupe='&request_type_id='+fldRequestType.id
			}
%>
		<input type="button" value="<%=tools.get_web_str('c_text_create_request')%>" class="inputButton" onmouseover="this.className='inputButtonOver';" onmouseout="this.className='inputButton';" style="width:140px " onclick="location.href='view_doc.html?mode=request_create&type=course&request_object_id=<%=_rec_course.course_id%><%=strRequestTupe%>';return false;">
<%
			}
%>
	</td>
	<%

		}
		catch ( t )
		{			
	%>
	<td class="<%=_class%>"><font color="#FF3300"><%=tools.get_web_str('c_deleted')%></font></td>
	<%
		}
	%>	
	<td class="<%=_classr%>"></td>		
</tr>
<%
	}
%>	
<tr>
	<td class="tableFooterLeft"><img src="pics/1blank.gif" width="0" height="0" /></td>
	<td class="tableFooter" colspan="2"><img src="pics/1blank.gif" width="0" height="0" /></td>
	<td class="tableFooterRight"><img src="pics/1blank.gif" width="0" height="0" /></td>
</tr> 
</table>
<%
}
%>	