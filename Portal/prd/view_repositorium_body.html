<%
	try
	{
		bMASTER_MODE = (bMASTER_MODE == true);
	}
	catch(_X_)
	{
		bMASTER_MODE = false;
	}
	if (!bMASTER_MODE)
	{
		try
		{
			curRepositoriumID = Int(Request.QueryString.repositorium_id);
			curRepositorium = OpenDoc(UrlFromDocID(curRepositoriumID)).TopElem;
		}
		catch(_O_)
		{
			curRepositoriumID = null;
			curRepositorium = null;
		}
	}
	
	if (curRepositoriumID == null)
	{
		if (!bMASTER_MODE)
		{
%>
		<center><font color="red">Error: Invalid repositorium</font></center>
<%
		}
	}
	else
	{
		curView = new Object;
		curView.SetProperty("id", "repositorium_list");
		curView.SetProperty("catalog_name", "resource");
		curView.SetProperty("array", QueryCatalogByKeys("resources", "id", ArrayExtract(curRepositorium.files, "PrimaryKey")) );
		curView.SetProperty("disp_link", true);
		curView.SetProperty("link_field_index", 1);
		
		curView.SetProperty("disp_check_box", true);
		Server.Execute("view_catalog_list.html");
		
%>
	<br/>
	<input type="button" value="<%=tools.get_web_str("c_delete")%>" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';" onclick="
		var _str = '';
		var _dead_list = document.getElementsByName('select_check_box_repositorium_list');
		var x=0;
		for (var i=0; i<_dead_list.length;i++)
		if (_dead_list[i].checked)
		{
			_str += (_str != '' ? ';': '') + _dead_list[i].id;
			x++;
		}
		if (_str != '' && confirm(<%=CodeLiteral( tools.get_web_str('vrb_conf_del_mess') )%>))
		$.getJSON('courselab/cl_postprocess.html', {mode: 'resource_clean',repositorium_id: '<%=curRepositoriumID%>', resource_ids: _str, datatype: 'json'}, function(json){if (json.message.status == 1) window.location.href = window.location.href; window.alert(json.message.text);});
		
	"/>
	<br/>
	<hr/>
	<br/>
<%
		Server.Execute("view_file_add.html");
		if (!bMASTER_MODE)
		{
%>
<script language="javascript">
<!--
	$("#update_repositorium_id").val("<%=curRepositoriumID%>");
	function postFileUploadFunc()
	{
		window.location.href=window.location.href;
	}
-->
</script>
<%
		}
	}
%>
<br/><br/>