<%
if ( curUser.access.access_role == 'admin' || curObject.person_id == curUserID )
{
%>
<form name="resource_form" action="resource_change.html" method="post">
<input type="hidden" name="object_id" value="<%=curObjectID%>"/>
<input type="hidden" name="doc_id" value="<%=curDocID%>"/>
<input type="hidden" name="sid" value="<%=tools.get_sum_sid( curDocID )%>"/>
<TABLE width="100%" cellspacing="0" cellpadding="4" CLASS="tableBorder">
	<TR>
		<TD WIDTH="200" ALIGN="RIGHT"><%=tools.get_web_str('c_code')%>:</TD>
		<td STYLE="font-weight:normal"><input type="text" name="code" value="<%=XmlAttrEncode( curObject.code )%>" class="inputEdit"/></td>
	</TR>
	<TR>
		<TD WIDTH="200" ALIGN="RIGHT"><%=tools.get_web_str('c_name')%>:</TD>
		<td STYLE="font-weight:normal"><input type="text" name="name" value="<%=XmlAttrEncode( curObject.name )%>" class="inputEdit" style="width: 100%"/></td>
	</TR>
	<TR>
		<TD WIDTH="200" ALIGN="RIGHT"><%=tools.get_web_str('c_type')%>:</TD>
		<td STYLE="font-weight:normal">
			<select name="type" id="resource_type">
<%
	for ( fldResourceType in common.resource_types )
	{
%>
				<option value="<%=fldResourceType.PrimaryKey%>"><%=fldResourceType.name%></option>
<%
	}
%>
			</select>
<SCRIPT language="JavaScript">
selcur=document.getElementById("resource_type");
selcur.selectedIndex==-1;
for (i=0;i<selcur.options.length;i++)
    if (selcur.options[i].value=="<%=curObject.type%>") {
        selcur.selectedIndex=i;
		break;
    }
</SCRIPT>
		</td>
	</TR>
	<TR>
		<TD WIDTH="200" ALIGN="RIGHT"><%=tools_web.get_web_str('vrb_file_name')%>:</TD>
		<TD STYLE="font-weight:normal"><%=curObject.file_name%>&nbsp;&nbsp;<a href="download_file.html?file_id=<%=curObjectID%>&sid=<%=tools.get_sum_sid( curObjectID )%>"><%=tools_web.get_web_str('vrb_download_file')%></a></TD>
	</TR>
	<TR>
		<TD WIDTH="200" ALIGN="RIGHT"><%=tools_web.get_web_str('vrb_links')%>:</TD>
		<TD STYLE="font-weight:normal"><%=curObject.use_count%></TD>
	</TR>
	<TR>
		<TD WIDTH="200" ALIGN="RIGHT"><%=tools.get_web_str('c_comment')%>:</TD>
		<td STYLE="font-weight:normal"><input type="text" name="comment" value="<%=XmlAttrEncode( curObject.comment )%>" class="inputEdit" style="width: 100%"/></td>
	</TR>
</TABLE>
<br/>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="activator">
	<tr>
		<td ALIGN="CENTER" class="activator">	
			<input type="submit" value="<%=tools_web.get_web_str('c_save')%>" class="inputButton" onMouseOver="this.className='inputButtonOver';" onMouseOut="this.className='inputButton';">
		</td>	
	</tr>
</table>
</form>
<%
	Server.Execute("view_knowledge_parts_base.html");
}
else
{
%>
<TABLE width="100%" cellspacing="0" cellpadding="4" CLASS="tableBorder">
	<TR>
		<TD WIDTH="200" ALIGN="RIGHT"><%=tools.get_web_str('c_code')%>:</TD>
		<TD STYLE="font-weight:normal"><%=curObject.code%></TD>
	</TR>
	<TR>
		<TD WIDTH="200" ALIGN="RIGHT"><%=tools.get_web_str('c_name')%>:</TD>
		<TD STYLE="font-weight:normal"><%=tools_web.get_cur_lng_name( curObject.name )%></TD>
	</TR>
	<TR>
		<TD WIDTH="200" ALIGN="RIGHT"><%=tools.get_web_str('c_type')%>:</TD>
		<TD STYLE="font-weight:normal"><%=curLngCommon.resource_types.GetChildByKey( curObject.type ).name%></TD>
	</TR>
	<TR>
		<TD WIDTH="200" ALIGN="RIGHT"><%=tools_web.get_web_str('vrb_file_name')%>:</TD>
		<TD STYLE="font-weight:normal"><%=curObject.file_name%>&nbsp;&nbsp;<%
			if (curObject.allow_unauthorized_download)
			{
		%><a href="download_file.html?file_id=<%=curObjectID%>&sid=<%=tools_web.get_sum_sid( curObjectID, Session.sid )%>"><%=tools_web.get_web_str("vrb_download_file")%></a>
		<%
			}
		%>
		</TD>
	</TR>
	<TR>
		<TD WIDTH="200" ALIGN="RIGHT"><%=tools_web.get_web_str('vrb_links')%>:</TD>
		<TD STYLE="font-weight:normal"><%=curObject.use_count%></TD>
	</TR>
	<TR>
		<TD WIDTH="200" ALIGN="RIGHT"><%=tools.get_web_str('c_comment')%>:</TD>
		<TD STYLE="font-weight:normal"><%=curObject.comment%></TD>
	</TR>
</TABLE>
<%
}

xarrRepoResources = ArraySelectDistinct(XQuery("for $elem in repositorium_resources where $elem/resource_id = " + curObjectID + " return $elem"), "repositorium_id");
if (ArrayOptFirstElem != undefined)
{
%>
	<br/>
	<b><%=tools_web.get_web_str('vrb_in_rep')%>:</b>
	<ul>
<%
	for (lcatRepoResourceElem in xarrRepoResources)
	{
%>
		<li><%=lcatRepoResourceElem.repositorium_name%></li>
<%
	}
%>
	</ul>
<%
}
%>
<br/>